Call flow for 2 dialogs (Color by Request/Response)
```
                                                                                                                        │
             10.190.9.11:5060            10.240.251.218:5060           10.240.251.218:5202             10.190.9.11:5060 │
          ──────────┬─────────          ──────────┬─────────          ──────────┬─────────          ──────────┬─────────│
  15:06:41.474593   │        INVITE (SDP)         │                             │                             │         │
        +0.000910   │ ──────────────────────────> │                             │                             │         │
  15:06:41.475503   │         100 Trying          │                             │                             │         │
        +0.014839   │ <────────────────────────── │                             │                             │         │
  15:06:41.490342   │                             │                             │        INVITE (SDP)         │         │
        +0.002924   │                             │                             │ ──────────────────────────> │         │
  15:06:41.493266   │  183 Session Progress (SDP) │                             │                             │         │
        +0.997144   │ <────────────────────────── │                             │                             │         │
  15:06:42.490410   │                             │                             │        INVITE (SDP)         │         │
        +1.999988   │                             │                             │ ────────────────────────>>> │         │
  15:06:44.490398   │                             │                             │        INVITE (SDP)         │         │
        +4.000001   │                             │                             │ ────────────────────────>>> │         │
  15:06:48.490399   │                             │                             │        INVITE (SDP)         │         │
        +8.000003   │                             │                             │ ────────────────────────>>> │         │
  15:06:56.490402   │                             │                             │        INVITE (SDP)         │         │
       +16.000003   │                             │                             │ ────────────────────────>>> │         │
  15:07:12.490405   │                             │                             │        INVITE (SDP)         │         │
        +1.002061   │                             │                             │ ────────────────────────>>> │         │
  15:07:13.492466   │     408 Request Timeout     │                             │                             │         │
        +0.008808   │ <────────────────────────── │                             │                             │         │
  15:07:13.501274   │             ACK             │                             │                             │         │
                    │ ──────────────────────────> │                             │                             │         │
                    │                             │                             │                             │         │
                    │                             │                             │                             │         │
```
----------------------------------------------------------------------------------------------------------------

- **10.190.9.11:5060** (источник/получатель)  
- **10.240.251.218:5060** (прокси/сервер)  
- **10.240.251.218:5202** (возможно, внутренний компонент)  

### Краткий анализ текущей последовательности:  
1. **INVITE (SDP)** отправлен от `10.190.9.11:5060` к `10.240.251.218:5060`.  
2. Сервер отвечает **100 Trying**, затем пересылает `INVITE` на `10.240.251.218:5202`.  
3. После этого `10.190.9.11` получает **183 Session Progress**, но `INVITE` продолжает переотправляться на `5202` (возможно, из-за отсутствия ответа).  
4. Через несколько таймаутов (`INVITE` повторяется с экспоненциальными интервалами: 2, 4, 8, 16 сек) `10.190.9.11` получает **408 Request Timeout** и отправляет **ACK**.  

### Проблемы:  
- **5202 порт не отвечает** на `INVITE`, что приводит к таймауту.  
- **408 Request Timeout** указывает на недоступность сервиса на `5202` или потерю пакетов.  

----------------------------------------------------------------------------------------------------------------


```
│INVITE sip:989163640234@10.240.251.218:5060;user=phone SIP/2.0
│Via: SIP/2.0/UDP 10.190.9.11:5060;branch=z9hG4bKr6daar6rga6pd983d3r9c7wrp
│Call-ID: wgwxpcb3brca6wg34agx9xgg9x7ab6ag@10.190.9.11
│From: "6899"<sip:6899@10.190.9.11;user=phone>;tag=w7bpl34r
│To: 989163640234 <sip:989163640234@10.240.251.218;user=phone>
│CSeq: 1 INVITE
│Contact: <sip:6899@10.190.9.11:5060;user=phone>;CallLocation=EXTERNAL
│Allow: INVITE,ACK,OPTIONS,BYE,CANCEL,REGISTER,INFO,PRACK,SUBSCRIBE,NOTIFY,UPDATE,
│PUBLISH
│Max-Forwards: 70
│Content-Length: 576
│Content-Type: application/sdp
│
│v=0
│o=HuaweieSpaceV200R003C50SPC900 918742 918742 IN IP4 10.190.9.11
│s=A conversation
│c=IN IP4 10.190.24.40
│t=0 0
│m=audio 10006 RTP/AVP 0 8 102 18 4 97 108 9 109 101
│a=rtpmap:0 PCMU/8000
│a=rtpmap:8 PCMA/8000
│a=rtpmap:102 G726-32/8000
│a=rtpmap:18 G729/8000
│a=fmtp:18 annexb=no
│a=rtpmap:4 G723/8000
│a=fmtp:4 bitrate=6.3;annexa=no
│a=rtpmap:97 iLBC/8000
│a=fmtp:97 mode=20
│a=rtpmap:108 AMR/8000
│a=fmtp:108 mode-set=7;octet-align=0
│a=rtpmap:9 G722/8000
│a=rtpmap:109 AMR-WB/16000
│a=fmtp:109 mode-set=8;octet-align=0
│a=rtpmap:101 telephone-event/8000
│a=sendrecv
```

### **стандартный SIP `INVITE`-запрос, инициирующий сеанс связи**  

## **1. Заголовки SIP**  

### **1.1. Основные поля**  
| Поле | Значение | Описание |
|------|---------|----------|
| **Request-Line** | `INVITE sip:989163640234@10.240.251.218:5060;user=phone SIP/2.0` | Запрос на установление сеанса с абонентом `989163640234` на сервере `10.240.251.218:5060`. Параметр `user=phone` указывает, что это телефонный номер. |
| **Via** | `SIP/2.0/UDP 10.190.9.11:5060;branch=z9hG4bKr6daar6rga6pd983d3r9c7wrp` | Указывает маршрут ответа (через `10.190.9.11:5060` по UDP). `branch` — уникальный идентификатор транзакции. |
| **Call-ID** | `wgwxpcb3brca6wg34agx9xgg9x7ab6ag@10.190.9.11` | Уникальный идентификатор вызова. |
| **From** | `"6899"<sip:6899@10.190.9.11;user=phone>;tag=w7bpl34r` | Инициатор вызова (`6899`), `tag` — идентификатор стороны. |
| **To** | `989163640234 <sip:989163640234@10.240.251.218;user=phone>` | Целевой абонент (`989163640234`). |
| **CSeq** | `1 INVITE` | Номер последовательности (1 — первый запрос). |
| **Contact** | `<sip:6899@10.190.9.11:5060;user=phone>;CallLocation=EXTERNAL` | Адрес для ответов. `CallLocation=EXTERNAL` может означать внешний вызов. |
| **Allow** | `INVITE,ACK,OPTIONS,BYE,CANCEL,REGISTER,INFO,PRACK,SUBSCRIBE,NOTIFY,UPDATE,PUBLISH` | Поддерживаемые методы SIP. |
| **Max-Forwards** | `70` | Максимальное число прокси-переходов (уменьшается на 1 при каждом форвардинге). |
| **Content-Length** | `576` | Размер SDP-тела (576 байт). |
| **Content-Type** | `application/sdp` | Тип содержимого (SDP — описание медиа-сессии). |



## **2. SDP (Session Description Protocol)**  
SDP описывает параметры медиа-потока (аудио, видео).  

### **2.1. Основные поля SDP**  
| Поле | Значение | Описание |
|------|---------|----------|
| **v=0** | `0` | Версия SDP. |
| **o=** | `HuaweieSpaceV200R003C50SPC900 918742 918742 IN IP4 10.190.9.11` | Идентификатор сессии (`HuaweieSpaceV200R003C50SPC900` — Huawei eSpace, IP `10.190.9.11`). |
| **s=** | `A conversation` | Название сессии. |
| **c=** | `IN IP4 10.190.24.40` | IP-адрес для медиа-потока (`10.190.24.40`). |
| **t=** | `0 0` | Время активности (0 0 — бесконечная сессия). |

### **2.2. Аудио-поток (`m=audio`)**  
```sdp
m=audio 10006 RTP/AVP 0 8 102 18 4 97 108 9 109 101
```  
- **Порт RTP:** `10006`  
- **Кодеки:**  
  - `0` — PCMU (G.711 μ-law)  
  - `8` — PCMA (G.711 A-law)  
  - `102` — G.726-32  
  - `18` — G.729  
  - `4` — G.723.1  
  - `97` — iLBC  
  - `108` — AMR  
  - `9` — G.722  
  - `109` — AMR-WB  
  - `101` — DTMF (RFC 2833)  

**Дополнительные атрибуты (`a=`):**  
- `a=rtpmap:X CODEC/CLOCKRATE` — сопоставление RTP-полезной нагрузки с кодеком.  
- `a=fmtp` — параметры кодеков (например, `mode=20` для iLBC означает 20 мс фреймы).  
- `a=sendrecv` — двусторонний поток (можно и `sendonly`/`recvonly`).  



## **3. Проблемы в этом `INVITE`**  
1. **Проблемы с ответом (`5202` порт):**  
   - В предыдущем логе видно, что `INVITE` пересылается на `10.240.251.218:5202`, но ответа нет.  
   - Возможные причины:  
     - Сервис на `5202` не запущен.  
     - NAT/Firewall блокирует трафик.  
     - Неправильная маршрутизация внутри сервера.  

2. **Возможные ошибки в SDP:**  
   - Если `10.190.24.40` недоступен для медиа-потока, вызов не установится.  
   - Некоторые кодеки (например, G.723.1) могут не поддерживаться удаленной стороной.  

----------------------------------------------------------------------------------------------------------------

















