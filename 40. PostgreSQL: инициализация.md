## –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î PostgreSQL –∏ —Å–ø–æ—Å–æ–±—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

###  **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î PostgreSQL**

#### 1. **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ init script**
```bash
# –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± (–≤ ALT Linux)
sudo /etc/init.d/postgresql initdb

# –ò–ª–∏ —á–µ—Ä–µ–∑ service
sudo service postgresql initdb
```

#### 2. **–†—É—á–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å –ø–æ–º–æ—â—å—é initdb**
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–ª—É–∂–±—É –µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω–∞
sudo systemctl stop postgresql.service

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∞—Å—Ç–µ—Ä –ë–î
sudo -u postgres /usr/libexec/postgresql17/initdb -D /var/lib/pgsql/data

# –ò–ª–∏ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
sudo -u postgres /usr/libexec/postgresql17/initdb \
  -D /var/lib/pgsql/data \
  --encoding=UTF8 \
  --locale=C.UTF-8 \
  --auth=scram-sha-256
```

#### 3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
sudo ls -la /var/lib/pgsql/data/

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo ls -la /var/lib/pgsql/data/pg_hba.conf
sudo ls -la /var/lib/pgsql/data/postgresql.conf
```

###  **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ pg_hba.conf**

#### 1. **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ pg_hba.conf –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞**
```bash
sudo nano /var/lib/pgsql/data/pg_hba.conf
```

#### 2. **–í–∞—Ä–∏–∞–Ω—Ç—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:**

**–í–∞—Ä–∏–∞–Ω—Ç A: Peer –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è socket (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**
```bash
# –ë—ã–ª–æ:
local   all             all                                     scram-sha-256

# –°—Ç–∞–ª–æ:
local   all             all                                     peer
```

**–í–∞—Ä–∏–∞–Ω—Ç B: Trust –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π**
```bash
local   all             postgres                                trust
local   all             all                                     peer
host    all             all             127.0.0.1/32            trust
```

**–í–∞—Ä–∏–∞–Ω—Ç C: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞**
```bash
# Socket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è - –±–µ–∑ –ø–∞—Ä–æ–ª—è
local   all             postgres                                peer
local   all             all                                     scram-sha-256

# TCP –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è - —Å –ø–∞—Ä–æ–ª–µ–º
host    all             all             127.0.0.1/32            scram-sha-256
host    all             all             ::1/128                 scram-sha-256
```

#### 3. **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π pg_hba.conf**
```bash
# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (–±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–ª—É–∂–±—ã)
sudo systemctl reload postgresql.service

# –ò–ª–∏ –ø–æ–ª–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
sudo systemctl restart postgresql.service
```

###  **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ .pgpass —Ñ–∞–π–ª–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

#### 1. **–°–æ–∑–¥–∞–Ω–∏–µ .pgpass —Ñ–∞–π–ª–∞**
```bash
# –î–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
echo "localhost:5432:*:postgres:–≤–∞—à_–ø–∞—Ä–æ–ª—å" > ~/.pgpass
chmod 600 ~/.pgpass

# –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è postgres
sudo -u postgres bash -c 'echo "localhost:5432:*:postgres:–≤–∞—à_–ø–∞—Ä–æ–ª—å" > ~/.pgpass'
sudo -u postgres chmod 600 ~/.pgpass
```

#### 2. **–§–æ—Ä–º–∞—Ç .pgpass —Ñ–∞–π–ª–∞**
```bash
# hostname:port:database:username:password
localhost:5432:*:postgres:–ø–∞—Ä–æ–ª—å
127.0.0.1:5432:*:postgres:–ø–∞—Ä–æ–ª—å
*:5432:*:postgres:–ø–∞—Ä–æ–ª—å  # –¥–ª—è –≤—Å–µ—Ö —Ö–æ—Å—Ç–æ–≤
```

#### 3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ .pgpass**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
ls -la ~/.pgpass

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
cat ~/.pgpass
```

### üîå **–û—Å–Ω–æ–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î**

#### 1. **–õ–æ–∫–∞–ª—å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ socket (–ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ pg_hba.conf)**
```bash
# –ë–µ–∑ –ø–∞—Ä–æ–ª—è (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω peer)
sudo -u postgres psql

# –° —É–∫–∞–∑–∞–Ω–∏–µ–º –±–∞–∑—ã
sudo -u postgres psql postgres

# –° –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∫–æ–º–∞–Ω–¥—ã
sudo -u postgres psql -c "SELECT version();"
```

#### 2. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ TCP/IP —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º .pgpass**
```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ .pgpass
psql -h localhost -U postgres -d postgres

# –° —É–∫–∞–∑–∞–Ω–∏–µ–º –ø–æ—Ä—Ç–∞
psql -h localhost -p 5432 -U postgres -d postgres
```

#### 3. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö**
```bash
psql -h localhost -U postgres -d –∏–º—è_–±–∞–∑—ã
```

#### 4. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –≤ connection string**
```bash
# –° –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º .pgpass
psql "postgresql://postgres@localhost:5432/postgres"

# –° —è–≤–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º –ø–∞—Ä–æ–ª—è (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
psql "postgresql://postgres:–ø–∞—Ä–æ–ª—å@localhost:5432/postgres"
```

#### 5. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ service file**

–§–∞–π–ª ~/.pg_service.conf —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–∞ —Ç–æ–π –º–∞—à–∏–Ω–µ, —Å –∫–æ—Ç–æ—Ä–æ–π –≤—ã –ø–æ–¥–∫–ª—é—á–∞–µ—Ç–µ—Å—å –∫ –ë–î (–Ω–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –º–∞—à–∏–Ω–µ), –∞ –Ω–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ë–î.
```bash
# –°–æ–∑–¥–∞—Ç—å ~/.pg_service.conf
echo "[mydb]
host=localhost        # –•–æ—Å—Ç, –≥–¥–µ —Ä–∞–±–æ—Ç–∞–µ—Ç PostgreSQL —Å–µ—Ä–≤–µ—Ä
user=postgres         # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
dbname=postgres       # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
port=5432" > ~/.pg_service.conf

psql service=mydb     # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å —Ç–µ–∫—É—â–µ–π –º–∞—à–∏–Ω—ã –∫ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É —Ö–æ—Å—Ç—É
```
```bash
# –ù–æ—É—Ç–±—É–∫ (–∫–ª–∏–µ–Ω—Ç) ‚Üí –£–¥–∞–ª—ë–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä (–ë–î)
# –°–æ–∑–¥–∞—ë–º –Ω–∞ –ù–û–£–¢–ë–£–ö–ï:
echo "[remote]
host=192.168.1.100    # IP —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ —Å PostgreSQL
user=postgres
dbname=myapp
port=5432" > ~/.pg_service.conf

psql service=remote
```
```bash
# –ù–∞ –ö–ê–ñ–î–û–ô –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –º–∞—à–∏–Ω–µ —Å–æ–∑–¥–∞—ë—Ç–µ —Å–≤–æ–π .pg_service.conf
# –ú–∞—à–∏–Ω–∞ 1 (–Ω–æ—É—Ç–±—É–∫):
echo "[dev]
host=dev-db.company.com
user=developer" > ~/.pg_service.conf

# –ú–∞—à–∏–Ω–∞ 2 (—Ä–∞–±–æ—á–∞—è —Å—Ç–∞–Ω—Ü–∏—è):  
echo "[dev]
host=dev-db.company.com
user=developer" > ~/.pg_service.conf
```

–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥:
```bash
# –°–æ–∑–¥–∞–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–Ω—Ñ–∏–≥–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π
echo "[local]
host=localhost
user=postgres
dbname=myapp_dev
port=5432

[staging] 
host=staging.db.com
user=myapp_user
dbname=myapp_staging
port=5432

[production]
host=prod.db.com
user=myapp_user
dbname=myapp_prod
port=5432" > ~/.pg_service.conf

# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω—É–∂–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
psql service=local      # –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
psql service=staging    # –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
psql service=production # –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
```

–ü–æ–ª–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è service file:
```bash
echo "[myservice]
host=server.example.com    # –•–æ—Å—Ç —Å–µ—Ä–≤–µ—Ä–∞ –ë–î (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
hostaddr=192.168.1.100     # IP –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
port=5432                  # –ü–æ—Ä—Ç PostgreSQL
dbname=mydatabase          # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
user=myuser                # –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
password=mypass            # –ü–∞—Ä–æ–ª—å (–Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ!)
connect_timeout=10         # –¢–∞–π–º–∞—É—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
sslmode=require            # –†–µ–∂–∏–º SSL" > ~/.pg_service.conf
```


###  **–ü–æ–ª–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ PostgreSQL**

#### –®–∞–≥ 1: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
```bash
sudo /etc/init.d/postgresql initdb
```

#### –®–∞–≥ 2: –ó–∞–ø—É—Å–∫ —Å–ª—É–∂–±—ã
```bash
sudo systemctl start postgresql.service
sudo systemctl enable postgresql.service
```

#### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–æ–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è postgres
```bash
sudo -u postgres psql -c "ALTER USER postgres PASSWORD '–≤–∞—à_–ø–∞—Ä–æ–ª—å';"
```

#### –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
```bash
# –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º pg_hba.conf
sudo nano /var/lib/pgsql/data/pg_hba.conf

# –ú–µ–Ω—è–µ–º –Ω–∞ —É–¥–æ–±–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
local   all             all                                     peer
```

#### –®–∞–≥ 5: –°–æ–∑–¥–∞–Ω–∏–µ .pgpass —Ñ–∞–π–ª–∞
```bash
echo "localhost:5432:*:postgres:–≤–∞—à_–ø–∞—Ä–æ–ª—å" > ~/.pgpass
chmod 600 ~/.pgpass
```

#### –®–∞–≥ 6: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
```bash
sudo systemctl reload postgresql.service
```

#### –®–∞–≥ 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
```bash
# –ß–µ—Ä–µ–∑ socket (–±–µ–∑ –ø–∞—Ä–æ–ª—è)
sudo -u postgres psql -c "\l"

# –ß–µ—Ä–µ–∑ TCP (—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º .pgpass)
psql -h localhost -U postgres -c "SELECT current_user;"
```

###  **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è**

#### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
```bash
sudo -u postgres createdb mydatabase
# –ò–ª–∏
psql -h localhost -U postgres -c "CREATE DATABASE mydatabase;"
```

#### –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
```bash
sudo -u postgres createuser myuser
# –ò–ª–∏
psql -h localhost -U postgres -c "CREATE USER myuser WITH PASSWORD 'mypassword';"
```

#### –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ –±–∞–∑:
```bash
psql -h localhost -U postgres -l
```

###  **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º**

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
sudo -u postgres psql -c "SELECT * FROM pg_hba_file_rules;"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
sudo -u postgres psql -c "SELECT * FROM pg_stat_activity;"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
sudo tail -f /var/lib/pgsql/data/log/postgresql-*.log
```

