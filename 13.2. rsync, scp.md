## § rsync, scp
----
  [cht.sh/rsync](https://cheat.sh/rsync)
<br/> [cht.sh/scp](https://cheat.sh/scp)


Команды `rsync` и `scp` — это мощные инструменты Linux для передачи файлов между компьютерами по сети. Они позволяют быстро и удобно копировать файлы удалённо, обеспечивая безопасность и удобство использования. Рассмотрим подробнее обе команды.

### Команда **rsync**

**Rsync** («remote sync») используется для синхронизации файлов и каталогов локально или удаленно. Основное преимущество заключается в эффективном обновлении больших объемов данных путем передачи только изменений, а не полного файла каждый раз.

#### Основные возможности:
- Передача изменений, а не полных файлов.
- Поддержка сжатия и шифрования данных.
- Возможность сохранения прав доступа, временных меток и символических ссылок.
- Простота использования.

#### Формат команды:
```bash
rsync опции источник пункт_назначения
```

##### Примеры использования:

1. **Копирование каталога с одного сервера на другой сервер:**
   ```bash
   rsync -avz /home/user/myfolder user@server:/home/backup/
   ```
   Здесь:
   - `a`: архивирует всю структуру папок рекурсивно, сохраняя права доступа и временные метки.
   - `v`: выводит подробный отчет процесса.
   - `z`: сжимает данные перед передачей.
   
2. **Синхронизация двух директорий с исключением определенных файлов:**
   ```bash
   rsync -avz --exclude '*.log' /var/www/html/ user@remotehost:/var/www/html/
   ```
   Файлы `.log` будут исключены из синхронизации.

3. **Создание резервной копии с использованием хардлинков (для экономии места):**
   ```bash
   rsync -avH /data /backup/data-snapshot
   ```
   Опция `H` сохраняет жесткие ссылки (`hard links`), экономя пространство на диске.

4. **Передача файла с указанием портов SSH:**
   ```bash
   rsync -avz -e 'ssh -p 2222' /path/to/file user@remotehost:/path/to/destination
   ```
   Если ваш SSH-сервер работает на нестандартном порте, используйте опцию `-e`.

---

### Команда **scp**

**Scp** («secure copy») предназначена для безопасной передачи файлов между хостами по протоколу SSH. Она обеспечивает надёжность и конфиденциальность благодаря встроенному шифрованию данных.

#### Формат команды:
```bash
scp опции файл_или_каталог пункт_назначения
```

##### Примеры использования:

1. **Копирование файла на удалённый сервер:**
   ```bash
   scp myfile.txt user@remotehost:/home/user/
   ```

2. **Получение файла с удалённого сервера:**
   ```bash
   scp user@remotehost:/home/user/myfile.txt .
   ```

3. **Рекурсивная передача всей директории:**
   ```bash
   scp -r /home/user/mydir user@remotehost:/home/user/
   ```
   Добавьте опцию `-r`, чтобы передать всё содержимое директории рекурсивно.

4. **Использование другого порта SSH:**
   ```bash
   scp -P 2222 myfile.txt user@remotehost:/home/user/
   ```
   Используйте `-P` для задания нестандартного номера порта SSH.

---

### Итоги

- Для быстрой и эффективной синхронизации большого количества файлов лучше подходит команда `rsync`. Особенно полезна, если часто обновляются большие объемы данных.
  
- Для одноразовых операций передачи файлов, особенно небольших размеров, проще воспользоваться командой `scp`.

Оба инструмента используют SSH-протокол, обеспечивая защиту передаваемых данных от перехвата и изменения.


