# § Пользователи

## Общее
<br/>Список пользователей посмотреть в файле */etc/passwd*
<br/>или командой: ```getent passwd```
<br/>Пароли хранятся в виде хешей в */etc/shadow*
<br/>Проверить существование пользователя: ```id <username>```
<br/>-----------------------------------------------------

- `user01:x:1000:1000:User One:/home/user01:/bin/bash` , где
    - **user01** - имя пользователя;
    - **x** - Пароль пользователя раньше хранился здесь в зашифрованном виде. Он был перенесен в файл /etc/shadow;
    - **1000** - Номер UID этой учетной записи пользователя;
    - **1000** - Номер GID основной группы для этой учетной записи пользователя;
    - **User One** - полное имя пользователя;
    - **/home/user01** - домашний каталог пользователя
    - **/bin/bash** - Программа оболочки по умолчанию для этого пользователя, которая запускается при входе в систему; для обычного пользователя это программа, предоставляющая командную строку. Системный пользователь может использовать команду **/sbin/nologin**, если интерактивный вход в систему для него не разрешен.



## Добавление:
1) ```useradd <имя пользователя> [опции]```
    -	-p - Задает пароль [useradd kiko0217 -p pass]
    -	-c - Создает комментарий для описания учетной записи [useradd kiko0217 -c "Пользователя для управления системой"]
    -	-m - При создании пользователя создать домашний каталог [useradd kiko0217 -m]
    -	-b - Задает базовый каталог для домашнего каталога [useradd kiko0217 -b /var/home]
    -	-d - Полный путь к домашнему каталогу пользователя [useradd kiko0217 -d /home/dmosk]
    -	-s - Путь до оболочки командной строки [useradd kiko0217 -s /bin/csh]
    -	-U - Имя группы будет таким же, как у пользователя
    -	-G - Задает дополнительные группы
    -	-g - Задает основную группу [useradd kiko0217 -g altternativegroup]
2) ```usermod -a -G <группы через запятую> <пользователь>```

## Редактирование:
1) Изменить имя пользователя:
<br/>	``sudo usermod --login new_username username``
2) Изменить UID:
<br/>	`sudo usermod --uid id username`
3) Изменить оболочку:
<br/>	`sudo usermod --shell path/to/shell username`
4) Изменить домашнюю папку:
<br/>	`sudo usermod --move-home --home path/to/new_home username`
5) Добавить доп. группы:
<br/>	`sudo usermod --append --groups group1,group2,... username`
6) passwd - смена для текущего пользователя
<br/> `passwd <имя пользователя> - конкретного`
7) mkpasswd -m sha-512 - генерация хэша пароля

## Удаление:
**Конфиги лежат в /etc/deluser.conf**
1) `userdel [список_опций] <имя_пользователя>`
    -	-f, --force - Принудительно удаляет пользователя, даже если у него есть запущенные процессы.
    -	-r, --remove - Удаляет домашнюю директорию учетной записи и все связанные с ней файлы.
    -	-Z, --selinux-user - Удаляет только SELinux-объекты, связанные с учетной записью.
2) `deluser [список_опций] <имя_пользователя>`
    -	--remove-all-files - Удаляет все файлы учетной записи, включая домашнюю директорию.
    -	--remove-all-groups - Удаляет учетную запись из всех групп.
3) удаление из группы
<br/>	`gpasswd --delete <пользователь> <группы через запятую>`
<br/>-----------------------------------------------------

# § Группы
1) `groupadd <группа> [опции]` - добавление
2) `groupmod <группа> [опции]` - редактирование
3) `groupdel <группа> [опции]` - удаление
<br/>-----------------------------------------------------
<br/> см. `getent passwd`
- `group01:x:978:root,user1,user2` , где
    - **group01** - имя группы;
    - **x** - Пароль пользователя раньше хранился здесь в зашифрованном виде. Он был перенесен в файл /etc/shadow;
    - **978** - Номер GID группы;
    - **root,user1,user2** - Список участников этой группы, для которых она является дополнительной.

# Примеры
-	`sudo useradd napo0721 -G wheel -m` - Создать учетную запись с возможностью получения привилегий суперпользователя (командой sudo su), для *CentOS*;
-	`sudo useradd napo0721 -G sudo -m` - для *DEB*.
-	`useradd dmosk -u 900 -g 950` - Создать пользователя с определенными UID и GID (соответственно идентификаторы пользователя и группы);
<br/> группа с используемым идентификатором (в данном примере 950) уже **должна быть *заранее* создана** с использованием команды groupadd
-	`useradd kiko0217 -d /home/new_kiko0217` - Создать пользователя *kiko0217* и указать путь к домашней директории
-	`useradd kiko0217 -s /sbin/nologin` - Создать учетную запись для пользователя *kiko0217* без возможности входа в систему
-	`chage -d 0 kiko0217` - Потребовать сменить пароль при следующем входе в систему
-	`chage -l kiko0217` - смотреть дату окончанию учётки
-	`chage -E -1 kiko0217` - бессрочная учётка
-	`usermod kiko0217 -g thenewgroup` - Поменять пользователю *kiko0217* основную группу
-	`usermod kiko0217 -G sudo` - Задать пользователю *kiko0217* дополнительную группу с правами root
-	`usermod -a -G group kiko0217` - Добавить пользователя *kiko0217* в группу
-	`usermod -d /var/www/kiko0217 kiko0217` - сменить домашнюю директорию
