# –®–ø–∞—Ä–≥–∞–ª–∫–∞ –ø–æ —Ñ–∞–π–ª–æ–≤—ã–º –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞–º, inode –∏ ulimit –≤ Linux

##  Inode (Index Node)

### –ß—Ç–æ —Ç–∞–∫–æ–µ inode?
**Inode** - —ç—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è –º–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–π–ª–µ (–∫—Ä–æ–º–µ –∏–º–µ–Ω–∏).

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å inode

```bash
# –ü–æ–∫–∞–∑–∞—Ç—å inode —Ñ–∞–π–ª–æ–≤
ls -i filename.txt

# –ü–æ–∫–∞–∑–∞—Ç—å inode —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
ls -li filename.txt

# –ü–æ–∫–∞–∑–∞—Ç—å inode –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
ls -ai

# –ù–∞–π—Ç–∏ —Ñ–∞–π–ª –ø–æ inode
find /path -inum 1234567

# –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ (–¥–æ—Å—Ç—É–ø–Ω—ã–µ inode)
df -i
```

### –ö–ª—é—á–µ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ inode:
- –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
- –í–ª–∞–¥–µ–ª–µ—Ü –∏ –≥—Ä—É–ø–ø–∞
- –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏
- –°—Å—ã–ª–∫–∏ –Ω–∞ –±–ª–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö


##  –§–∞–π–ª–æ–≤—ã–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã (File Descriptors)

### –ß—Ç–æ —Ç–∞–∫–æ–µ —Ñ–∞–π–ª–æ–≤—ã–π –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä?
**FD** - —á–∏—Å–ª–æ–≤–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π —è–¥—Ä–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å—É –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Ñ–∞–π–ª–∞/—Å–æ–∫–µ—Ç–∞.

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–æ–≤—ã–º–∏ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞–º–∏

```bash
# –ü–æ–∫–∞–∑–∞—Ç—å FD —Ç–µ–∫—É—â–µ–≥–æ shell-–ø—Ä–æ—Ü–µ—Å—Å–∞
ls -l /proc/$$/fd/

# –ü–æ–∫–∞–∑–∞—Ç—å FD –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
ls -l /proc/<PID>/fd/

# –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ —Ñ–∞–π–ª—ã –≤ —Å–∏—Å—Ç–µ–º–µ
lsof

# –ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã–µ —Ñ–∞–π–ª—ã –ø—Ä–æ—Ü–µ—Å—Å–æ–º
lsof -p <PID>

# –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ —Ñ–∞–π–ª
lsof /path/to/file

# –°–æ–∑–¥–∞—Ç—å FD –≤—Ä—É—á–Ω—É—é –≤ bash
exec 3>file.txt    # FD 3 –¥–ª—è –∑–∞–ø–∏—Å–∏
exec 4<file.txt    # FD 4 –¥–ª—è —á—Ç–µ–Ω–∏—è
echo "test" >&3    # –∑–∞–ø–∏—Å—å —á–µ—Ä–µ–∑ FD 3
```

### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ñ–∞–π–ª–æ–≤—ã–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã:
- **0** - stdin (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤–≤–æ–¥)
- **1** - stdout (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–≤–æ–¥)  
- **2** - stderr (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –æ—à–∏–±–∫–∞)



##  Ulimit - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞–º–∏ —Ä–µ—Å—É—Ä—Å–æ–≤

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã ulimit

```bash
# –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —Ç–µ–∫—É—â–∏–µ –ª–∏–º–∏—Ç—ã
ulimit -a

# –ü–æ–∫–∞–∑–∞—Ç—å –ª–∏–º–∏—Ç —Ñ–∞–π–ª–æ–≤—ã—Ö –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤
ulimit -n

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ª–∏–º–∏—Ç FD
ulimit -n 4096

# –ü–æ–∫–∞–∑–∞—Ç—å hard limit
ulimit -H -n

# –ü–æ–∫–∞–∑–∞—Ç—å soft limit  
ulimit -S -n

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ª–∏–º–∏—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
ulimit -u 1000
```

### –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –æ–ø—Ü–∏–∏:
```bash
-a  # –í—Å–µ –ª–∏–º–∏—Ç—ã
-n  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤
-u  # –ú–∞–∫—Å–∏–º—É–º –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
-t  # –ú–∞–∫—Å–∏–º—É–º CPU time (—Å–µ–∫—É–Ω–¥—ã)
-v  # –ú–∞–∫—Å–∏–º—É–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏
-f  # –ú–∞–∫—Å–∏–º—É–º —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤
```



##  –í–∑–∞–∏–º–æ—Å–≤—è–∑—å –ø–æ–Ω—è—Ç–∏–π

### –¶–µ–ø–æ—á–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª—É:
```
–ü—Ä–æ—Ü–µ—Å—Å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ñ–∞–π–ª 
    ‚Üì
–Ø–¥—Ä–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–∞–π–ª–æ–≤—ã–π –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä (FD)
    ‚Üì
FD —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω—É—é —Ç–∞–±–ª–∏—Ü—É —Ñ–∞–π–ª–æ–≤
    ‚Üì
–°–∏—Å—Ç–µ–º–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ inode
    ‚Üì
Inode —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –¥–∏—Å–∫–µ
```

### –ê–Ω–∞–ª–æ–≥–∏—è:
- **Inode** = –ü–∞—Å–ø–æ—Ä—Ç —Ñ–∞–π–ª–∞ (–ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π)
- **File Descriptor** = –ß–∏—Ç–∞—Ç–µ–ª—å—Å–∫–∏–π –±–∏–ª–µ—Ç (–≤—Ä–µ–º–µ–Ω–Ω—ã–π)
- **Ulimit** = –û—Ö—Ä–∞–Ω–Ω–∏–∫, –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–π –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏–ª–µ—Ç–æ–≤



##  –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ FD –ø—Ä–æ—Ü–µ—Å—Å–æ–º
ls -l /proc/<PID>/fd/ | wc -l

# –ù–∞–π—Ç–∏ —É—Ç–µ—á–∫–∏ FD
lsof -p <PID> | wc -l

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ inode –≤ –§–°
df -i

# –£–≤–µ–ª–∏—á–∏—Ç—å –ª–∏–º–∏—Ç FD –¥–ª—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞
ulimit -n 65536
```

### –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–∏–º–∏—Ç–æ–≤
```bash
# –î–æ–±–∞–≤–∏—Ç—å –≤ ~/.bashrc
ulimit -n 8192

# –ò–ª–∏ –≤ /etc/security/limits.conf
# * soft nofile 8192
# * hard nofile 65536
```



##  –ü–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã

1. **–ü—Ä–∏ "Too many open files"** - —É–≤–µ–ª–∏—á—å—Ç–µ `ulimit -n`
2. **–ü—Ä–∏ "No space left on device"** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ `df -i` (–º–æ–≥–ª–∏ –∫–æ–Ω—á–∏—Ç—å—Å—è inode)
3. **–î–ª—è —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π** –≤—Å–µ–≥–¥–∞ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ –∞–¥–µ–∫–≤–∞—Ç–Ω—ã–µ –ª–∏–º–∏—Ç—ã
4. **FD –æ—Å–≤–æ–±–æ–∂–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞
5. **Inode —Å–æ–∑–¥–∞—é—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –§–°** –∏ –∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ

--------------------------------------

#  Inode –≤ Linux: –ª–∏–º–∏—Ç—ã –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

##  –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ inode –≤ —Å–∏—Å—Ç–µ–º–µ

### 1. **–§–∞–∫—Ç–æ—Ä—ã, –≤–ª–∏—è—é—â–∏–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ inode:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ inode –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
df -i
# –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞    Inodes IUsed IFree IUse% Mounted on
# /dev/sda1          5242880 15000 5227880    1% /

# –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –§–°
tune2fs -l /dev/sda1 | grep -i inode
```

### 2. **–õ–∏–º–∏—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:**

| –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ | Inode –Ω–∞ 1GB | –ú–∞–∫—Å–∏–º—É–º inode |
|------------------|--------------|----------------|
| ext4             | ~16,000      | ~4 –º–∏–ª–ª–∏–∞—Ä–¥–∞   |
| xfs              | ~18,000      | ~2^64          |
| btrfs            | –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ | –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ |

### 3. **–ö–∞–∫ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ inode:**

```bash
# –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –§–° –∑–∞–¥–∞–µ—Ç—Å—è —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ:
mkfs.ext4 -i 16384 /dev/sda1  # 1 inode –Ω–∞ 16KB –¥–∞–Ω–Ω—ã—Ö
# –∏–ª–∏
mkfs.ext4 -N 1000000 /dev/sda1  # —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ inode
```



##  –°–∏–º–ø—Ç–æ–º—ã –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è inode

### –ü—Ä–∏–∑–Ω–∞–∫–∏ –ø—Ä–æ–±–ª–µ–º—ã:
```bash
# 1. –û—à–∏–±–∫–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ñ–∞–π–ª–æ–≤
touch new_file.txt
# touch: cannot touch 'new_file.txt': No space left on device

# 2. –ù–æ df -h –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ
df -h
# Filesystem      Size  Used Avail Use% Mounted on
# /dev/sda1        50G   30G   20G  60% /

# 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º inode
df -i
# Filesystem     Inodes IUsed IFree IUse% Mounted on
# /dev/sda1      5242880 5242880 0    100% /
```



##  –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –ø–æ–∏—Å–∫ –ø—Ä–æ–±–ª–µ–º

### 1. **–ù–∞–π—Ç–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ñ–∞–π–ª–æ–≤:**
```bash
# –ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ø-10 –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Ñ–∞–π–ª–æ–≤
find / -xdev -type f | cut -d "/" -f 2 | sort | uniq -c | sort -rn | head -10

# –ò–ª–∏ –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–π –º–µ—Ç–æ–¥:
find /path/to/check -xdev -printf '%h\n' | sort | uniq -c | sort -rn | head -20
```

### 2. **–ü–æ–∏—Å–∫ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –º–∞–ª–µ–Ω—å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤:**
```bash
# –ù–∞–π—Ç–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ñ–∞–π–ª–æ–≤
for dir in /*; do
    if [ -d "$dir" ]; then
        count=$(find "$dir" -type f 2>/dev/null | wc -l)
        echo "$count - $dir"
    fi
done | sort -rn

# –ü–æ–∏—Å–∫ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
find /var -type f 2>/dev/null | wc -l
```

### 3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –º–µ—Å—Ç–∞:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å /tmp
ls -f /tmp | wc -l

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—á—Ç–æ–≤—ã–µ –æ—á–µ—Ä–µ–¥–∏
find /var/spool/postfix -type f | wc -l

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
find /var/log -type f | wc -l

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Å—Å–∏–∏ PHP
find /var/lib/php/sessions -type f | wc -l
```



##  –û—á–∏—Å—Ç–∫–∞ –∑–∞–Ω—è—Ç—ã—Ö inode

### 1. **–û—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤:**
```bash
# –û—á–∏—Å—Ç–∫–∞ /tmp
sudo find /tmp -type f -atime +7 -delete

# –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –ø–∞–∫–µ—Ç–æ–≤
sudo apt-get clean
# –∏–ª–∏ –¥–ª—è yum
sudo yum clean all
```

### 2. **–û—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤:**
```bash
# –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤
sudo logrotate -f /etc/logrotate.conf

# –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤
sudo find /var/log -name "*.log.*" -type f -mtime +30 -delete
sudo find /var/log -name "*.gz" -type f -mtime +30 -delete
```

### 3. **–û—á–∏—Å—Ç–∫–∞ –ø–æ—á—Ç–æ–≤—ã—Ö –æ—á–µ—Ä–µ–¥–µ–π:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—á—Ç–æ–≤—É—é –æ—á–µ—Ä–µ–¥—å
sudo mailq

# –û—á–∏—Å—Ç–∏—Ç—å –≤—Å—é –æ—á–µ—Ä–µ–¥—å
sudo postsuper -d ALL

# –ò–ª–∏ –≤—ã–±–æ—Ä–æ—á–Ω–æ
sudo find /var/spool/postfix -type f -delete
```

### 4. **–û—á–∏—Å—Ç–∫–∞ —Å–µ—Å—Å–∏–π:**
```bash
# PHP —Å–µ—Å—Å–∏–∏
sudo find /var/lib/php/sessions -type f -mtime +1 -delete

# –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–µ—Å—Å–∏–∏
sudo find /tmp -name "sess_*" -type f -mtime +1 -delete
```



##  –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ –º–µ—Ä—ã

### –ï—Å–ª–∏ —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–¥–∞–ª—è—Ç—å —Ñ–∞–π–ª—ã:
```bash
# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –≤ single mode
sudo systemctl rescue

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞
# –í–ê–ñ–ù–û: –ë—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã —Å —ç—Ç–∏–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏!

# –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ —à–∞–±–ª–æ–Ω—É
sudo find /path -name "*.tmp" -delete

# –û—á–∏—Å—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤
sudo find /path -type f -size 0 -delete
```



##  –ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ inode –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Å–µ—Ö –§–°:**
```bash
#!/bin/bash

THRESHOLD=90
ALERT_TRIGGERED=0

echo "=== INODE USAGE REPORT ==="
date

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ —Ñ–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã –∫—Ä–æ–º–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö
df -i | grep -E '^/dev/' | while read line; do
    USAGE=$(echo $line | awk '{gsub(/%/,"",$5); print $5}')
    FILESYSTEM=$(echo $line | awk '{print $1}')
    MOUNT_POINT=$(echo $line | awk '{print $6}')
    
    if [[ "$USAGE" =~ ^[0-9]+$ ]] && [ "$USAGE" -gt "$THRESHOLD" ]; then
        echo "üö® ALERT: $FILESYSTEM on $MOUNT_POINT is at ${USAGE}% inode usage"
        ALERT_TRIGGERED=1
    else
        echo "‚úÖ OK: $FILESYSTEM on $MOUNT_POINT - ${USAGE}%"
    fi
done

if [ "$ALERT_TRIGGERED" -eq 1 ]; then
    echo ""
    echo "=== RECOMMENDED ACTIONS ==="
    echo "1. Check for many small files: find /path -type f | wc -l"
    echo "2. Clean temporary files"
    echo "3. Check log files rotation"
fi
```

### 2. **–°–æ–∑–¥–∞–Ω–∏–µ –§–° —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º inode:**
```bash
# –î–ª—è –§–° —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –º–∞–ª–µ–Ω—å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
mkfs.ext4 -i 4096 -I 512 /dev/sdb1  # –±–æ–ª—å—à–µ inode

# –î–ª—è –§–° —Å –±–æ–ª—å—à–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏
mkfs.ext4 -i 65536 /dev/sdb1  # –º–µ–Ω—å—à–µ inode
```

### 3. **–ü–µ—Ä–µ–Ω–æ—Å –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –§–° —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ inode:**
```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å btrfs –∏–ª–∏ xfs –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–¥–µ–ª–µ–Ω–∏—è inode
mkfs.btrfs /dev/sdb1
# –∏–ª–∏
mkfs.xfs /dev/sdb1
```



##  –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:
```bash
# –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ inode
watch -n 3600 'df -i'

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
#!/bin/bash
echo "=== Inode Usage ==="
df -i
echo ""
echo "=== Top directories by file count ==="
find / -xdev -type f 2>/dev/null | cut -d "/" -f 2,3 | sort | uniq -c | sort -rn | head -10
```



##  –ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ä—ã

1. **–†–µ–≥—É–ª—è—Ä–Ω–æ –º–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ** `df -i`
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è** –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ 80% –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –§–° —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ inode** (btrfs, xfs) –¥–ª—è workload'–æ–≤ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –º–∞–ª–µ–Ω—å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
4. **–†–µ–≥—É–ª—è—Ä–Ω–æ —á–∏—Å—Ç–∏—Ç–µ** –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ –∫—ç—à–∏
5. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ logrotate** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–æ–≥–∞–º–∏

**–í–∞–∂–Ω–æ:** –ü–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏ inode –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤!
