NFS-Ganesha может быть хорошей альтернативой стандартному `nfs-kernel-server` для нашего кластера Jira, особенно если у вас нестандартное ядро (6.8.12-9-pve).  

### **1. Совместимость NFS-Ganesha с Jira**  
Да, **NFS-Ganesha** может работать с Jira, так как:  
- Поддерживает протоколы **NFSv3, NFSv4, NFSv4.1**, которые использует Jira.  
- Работает в **пользовательском пространстве (userspace)**, что делает его более гибким и менее зависимым от версии ядра.  
- Поддерживается в Debian/Proxmox и может быть настроен как сервер или клиент.  

### **2. Проверка требований Jira к NFS**  
Jira официально поддерживает хранение данных на NFS, но с оговорками:  
- **NFSv3 или NFSv4** (лучше NFSv4 из-за улучшенной блокировки файлов).  
- **Требуется `nolock` или `lockd` для корректной работы.**  
- Желательно **отключить `atime`** для снижения нагрузки.  

### **3. Установка и настройка NFS-Ganesha на Proxmox (jira-cluster и jira-new)**  

#### **Установка NFS-Ganesha (на сервере, например, jira-cluster)**  
```bash
apt update
apt install nfs-ganesha nfs-ganesha-vfs -y
```

#### **Конфигурация NFS-Ganesha (`/etc/ganesha/ganesha.conf`)**  
```ini
EXPORT {
    Export_ID = 1;
    Path = /var/lib/jira/shared;  # Путь к данным Jira
    Pseudo = /jira_share;
    Access_Type = RW;
    Squash = No_Root_Squash;
    Protocols = 3, 4;
    Transports = TCP;
    FSAL {
        Name = VFS;
    }
}
```
> **Примечание**:  
> - `/var/lib/jira/shared` — стандартный путь для shared-данных Jira.  
> - Если используется кластер Jira, этот каталог должен быть общим для всех нод.  

#### **Запуск и проверка сервера**  
```bash
systemctl restart nfs-ganesha
systemctl enable nfs-ganesha
showmount -e localhost  # Проверка экспорта
```

#### **Монтирование NFS на клиенте (jira-new)**  
```bash
apt install nfs-common -y
mkdir -p /var/lib/jira/shared
mount -t nfs4 192.168.87.140:/jira_share /var/lib/jira/shared -o rw,noatime,nolock
```
Добавьте в `/etc/fstab` для автоматического монтирования:  
```bash
192.168.87.140:/jira_share  /var/lib/jira/shared  nfs4  rw,noatime,nolock  0  0
```

### **4. Проверка работы**  
- На сервере (`jira-cluster`):  
  ```bash
  cat /var/log/ganesha.log  # Логи сервера
  ```
- На клиенте (`jira-new`):  
  ```bash
  df -h | grep jira  # Проверка монтирования
  touch /var/lib/jira/shared/test && ls -la /var/lib/jira/shared  # Проверка записи
  ```

### **5. Дополнительные настройки для Jira**  
- Убедитесь, что **права на файлы** (`chown -R jira:jira /var/lib/jira/shared`) корректны.  
- В `jira-config.properties` укажите путь к shared-директории.  



Если нужна помощь с тонкой настройкой (`cache`, `failover` в NFS-Ganesha), уточните детали!



