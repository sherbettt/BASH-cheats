# Цветной вывод логов и списков файлов в Linux

Чтобы сделать цветной вывод команды `tail -f` или других утилит, можно использовать различные инструменты для цветового форматирования вывода.

## 1. **Использование `grep` с цветным выводом**

Если в лог-файле есть ключевые слова (например, `ERROR`, `WARNING`), можно подсветить их с помощью `grep --color`:

```bash
tail -f /var/log/syslog | grep --color -E 'ERROR|WARNING|INFO'
```

```bash
rpm -ql openssh-server | grep --color=always -E "etc|usr|lib|share"

# Или с цветным выводом через grep
rpm -ql openssh-server | grep --color=always -E "^/etc|^/usr|^/lib"
```

Если нужно сохранить все строки, но подсветить определённые паттерны:
```bash
tail -f /var/log/syslog | grep --color -E '.*ERROR.*|.*WARNING.*|$'
```
(где `$` означает "любая строка")

<br/>

## 2. **Использование `ccze` для цветного вывода**

`ccze` — это утилита для цветного вывода логов с гибкими настройками цветов. Установите её:

```bash
sudo apt install ccze  # Debian/Ubuntu
sudo yum install ccze  # CentOS/RHEL (если есть в репозиториях)
```

### Базовое использование:
```bash
tail -f /var/log/syslog | ccze -A
```

### Выбор плагина для разных типов логов:
```bash
# Для системных логов
tail -f /var/log/syslog | ccze -p syslog -A

# Для веб-серверов
tail -f /var/log/apache2/access.log | ccze -p httpd -A

# Для FTP логов
tail -f /var/log/xferlog | ccze -p xferlog -A
```

### Просмотр доступных плагинов:
```bash
ccze --list-plugins
```

### Ручная настройка цветов:
```bash
# Кастомные цвета для уровней логирования
tail -f /var/log/syslog | ccze \
  -c "DEBUG=cyan" \
  -c "INFO=green" \
  -c "WARNING=yellow" \
  -c "ERROR=red" \
  -c "date=blue" \
  -A

# Для IP-адресов и URL
tail -f /var/log/apache2/access.log | ccze \
  -c "ip=magenta" \
  -c "url=green" \
  -c "method=bold" \
  -A
```

### HTML вывод:
```bash
# Сохранение в HTML файл
tail -f /var/log/syslog | ccze -h > logs.html
```

<br/>

## 3. **Использование `multitail`**

`multitail` — это продвинутый инструмент для просмотра логов с цветовой разметкой. Установка:

```bash
sudo apt install multitail  # Debian/Ubuntu
sudo yum install multitail  # CentOS/RHEL
```

### Примеры использования:
```bash
# Просмотр системного лога
multitail /var/log/syslog

# Просмотр нескольких логов одновременно
multitail /var/log/syslog /var/log/auth.log

# С цветовой схемой для конфигурационных файлов
multitail -cS conf /etc/ssh/sshd_config

# Просмотр вывода команды
rpm -ql openssh-server | multitail -j
```

### Создание временных файлов для анализа:
```bash
# Анализ списка файлов RPM
rpm -ql openssh-server > /tmp/ssh-files.txt
multitail /tmp/ssh-files.txt

# Подсветка конфигурационных файлов
rpm -ql openssh-server | grep -E "\.conf|config" | multitail -cS conf -l "cat"
```

<br/>

## 4. **Использование `sed` для ручной подсветки**

Можно вручную задать цвета с помощью `sed` и ANSI-кодов:

```bash
tail -f /var/log/syslog | sed \
    -e 's/\(.*ERROR.*\)/\x1b[31m\1\x1b[0m/' \
    -e 's/\(.*WARNING.*\)/\x1b[33m\1\x1b[0m/' \
    -e 's/\(.*INFO.*\)/\x1b[32m\1\x1b[0m/' \
    -e 's/\(.*DEBUG.*\)/\x1b[36m\1\x1b[0m/'
```

### Расширенная версия с большим количеством цветов:
```bash
tail -f /var/log/syslog | sed \
    -e 's/\(CRITICAL\)/\x1b[1;31m\1\x1b[0m/g' \
    -e 's/\(ERROR\)/\x1b[31m\1\x1b[0m/g' \
    -e 's/\(WARNING\)/\x1b[33m\1\x1b[0m/g' \
    -e 's/\(INFO\)/\x1b[32m\1\x1b[0m/g' \
    -e 's/\(DEBUG\)/\x1b[36m\1\x1b[0m/g' \
    -e 's/\([0-9]\+\.[0-9]\+\.[0-9]\+\.[0-9]\+\)/\x1b[35m\1\x1b[0m/g'
```

Где:
- `\x1b[31m` — красный
- `\x1b[33m` — жёлтый
- `\x1b[32m` — зелёный
- `\x1b[36m` — голубой
- `\x1b[35m` — magenta
- `\x1b[1;31m` — ярко-красный
- `\x1b[0m` — сброс цвета

<br/>

## 5. **Использование `lnav` (продвинутый просмотр логов)**

`lnav` — это мощный инструмент для анализа логов с подсветкой синтаксиса и навигацией. Установка:

```bash
sudo apt install lnav  # Debian/Ubuntu
sudo yum install lnav  # CentOS/RHEL
```

### Использование:
```bash
# Просмотр одного файла
lnav /var/log/syslog

# Просмотр всех логов в директории
lnav /var/log/

# Просмотр в реальном времени
lnav -t /var/log/syslog

# С определенным форматом лога
lnav -c ":set-filetype syslog" /var/log/custom.log
```

## Сравнение инструментов

| Инструмент | Сложность | Гибкость | Лучшее применение |
|------------|-----------|----------|-------------------|
| `grep --color` | Простая | Ограниченная | Быстрая подсветка ключевых слов |
| `ccze` | Средняя | Хорошая | Просмотр логов в реальном времени с плагинами |
| `multitail` | Сложная | Очень гибкая | Мониторинг нескольких логов одновременно |
| `sed` | Сложная | Полная | Точная ручная настройка цветов |
| `lnav` | Средняя | Хорошая | Анализ и навигация по историческим логам |

## Практические примеры для разных сценариев

### Для мониторинга в реальном времени:
```bash
# Простой способ
tail -f /var/log/syslog | ccze -p syslog -A

# С подсветкой ошибок
tail -f /var/log/syslog | grep --color -E 'ERROR|WARNING|CRITICAL'

# Продвинутый мониторинг
multitail -cS syslog /var/log/syslog -cS auth /var/log/auth.log
```

### Для анализа исторических логов:
```bash
# С цветами для быстрого анализа
cat /var/log/syslog | ccze -p syslog -A | less -R

# С навигацией и поиском
lnav /var/log/syslog
```

### Для файлов конфигурации:
```bash
# Просмотр с подсветкой синтаксиса
multitail -cS conf /etc/ssh/sshd_config

# Или с ccze
cat /etc/ssh/sshd_config | ccze -A
```

## Вывод

- **Для быстрой подсветки** ключевых слов используйте `grep --color`
- **Для красивого форматирования** логов в реальном времени используйте `ccze` с подходящим плагином
- **Для мониторинга нескольких логов** одновременно идеально подходит `multitail`
- **Для глубокого анализа** исторических логов выбирайте `lnav`
- **Для полного контроля** над цветами используйте `sed` с ANSI-кодами

Каждый инструмент имеет свои преимущества, поэтому выбирайте в зависимости от конкретной задачи и предпочтений.
