### § Partitions. Создание разделов.

[ch06s04.htm](https://rh.schelcol.ru/curse%202/ch06s04.html)
<br/> [cheat.sh/parted](https://cheat.sh/parted)
<br/> [cheat.sh/fdisk](https://cheat.sh/fdisk)
<br/> [man/mkfs.xfs](https://manned.org/man/mkfs.xfs)
<br/> [cheat.sh/mkfs.exfat](https://cheat.sh/mkfs.exfat)
<br/> [cheat.sh/lsblk](https://cheat.sh/lsblk)
<br/> [cheat.sh/blkid](https://cheat.sh/blkid)


- Посмотреть все блочные у-ва.
    <br/> `lsblk -pf {-ps|-sf}`
    ```c
    [root@servera ~]# lsblk -pf
    NAME               FSTYPE LABEL UUID                                 MOUNTPOINT
    /dev/vda
    ├─/dev/vda1
    ├─/dev/vda2        vfat         399C-0F7D                            /boot/efi
    └─/dev/vda3        xfs    root  3cd0d4ca-93f6-423b-a469-70ab2b10b667 /
    /dev/vdb
    /dev/vdc
    /dev/vdd
    └─/dev/mapper/vd01 xfs          6189efca-e273-4943-865d-0e2d7bbc1264
    ```
- Создать новую метку **msdos** на диске **/dev/vdb** и подготовить этот новый диск для таблицы разделов MBR {GPT}.
    <br/> `parted /dev/vdb mklabel msdos {gpt}`

- Создать основной раздел размером 1 ГБ. Для правильного выравнивания раздел начнётся с сектора 2048. Задать XFS в качестве типа файловой системы раздела.
    <br/> `parted /dev/vdb mkpart primary xfs 2048s 1001MB`
    - Создать основной раздел размером 2 ГБ для бекапа.
      <br/> `parted /dev/vdb mkpart backup xfs 2048s 2GB`
- Отобразить список разделов на /dev/vdb, чтобы проверить результат.
    <br/> `parted /dev/vdb print`
    ```c
    Model: Virtio Block Device (virtblk)
    Disk /dev/vdb: 5369MB
    Sector size (logical/physical): 512B/512B
    Partition Table: msdos
    Disk Flags:

    Number  Start   End     Size    Type     File system  Flags
     1      1049kB  1001MB  1000MB  primary
    ```
- Зарегистрировать новый раздел.
  <br/> `udevadm settle`
- Отформатировать новый раздел под файловую систему XFS.
      <br/> `mkfs.xfs /dev/vdb1`
    ```c
    [root@servera ~]# mkfs.xfs /dev/vdb1
    meta-data=/dev/vdb1              isize=512    agcount=4, agsize=61056 blks
             =                       sectsz=512   attr=2, projid32bit=1
             =                       crc=1        finobt=1, sparse=1, rmapbt=0
             =                       reflink=1
    data     =                       bsize=4096   blocks=244224, imaxpct=25
             =                       sunit=0      swidth=0 blks
    naming   =version 2              bsize=4096   ascii-ci=0, ftype=1
    log      =internal log           bsize=4096   blocks=1566, version=2
             =                       sectsz=512   sunit=0 blks, lazy-count=1
    realtime =none                   extsz=4096   blocks=0, rtextents=0
    ```
    
   Проверим UUID созданных блочных у-в.
  
    ```c
    [root@servera ~]# lsblk -pf
    NAME               FSTYPE LABEL UUID                                 MOUNTPOINT
    /dev/vda
    ├─/dev/vda1
    ├─/dev/vda2        vfat         399C-0F7D                            /boot/efi
    └─/dev/vda3        xfs    root  3cd0d4ca-93f6-423b-a469-70ab2b10b667 /
    /dev/vdb
    └─/dev/vdb1        xfs          979c770c-0e0d-47bf-a6ed-d72102ddc12a
    /dev/vdc
    /dev/vdd
    └─/dev/mapper/vd01 xfs          6189efca-e273-4943-865d-0e2d7bbc1264
    ```
- Настроить монтирование новой файловой системы в директорию **/archive** на постоянной основе.
  <br/> `mkdir /archive`
  <br/> `lsblk --fs /dev/vdb`
    - Добавить запись в /etc/fstab
    - ```c
      UUID=3cd0d4ca-93f6-423b-a469-70ab2b10b667 /                       xfs     defaults        0 0
      UUID=399C-0F7D          /boot/efi               vfat    defaults,uid=0,gid=0,umask=077,shortname=winnt 0 2
      UUID=979c770c-0e0d-47bf-a6ed-d72102ddc12a /archive xfs defaults  0 0
      ```
- Обновить systemd, чтобы система зарегистрировала новую конфигурацию /etc/fstab.
  <br/> `systemctl daemon-reload`
- Смонтировать новую файловую систему, используя запись, добавленную в /etc/fstab.
  <br/> `mount /archive`
- Убедиться, что новая файловая система смонтирована в /archive.
  ```c
  [root@servera ~]# mount | grep /archive
  /dev/vdb1 on /archive type xfs (rw,relatime,seclabel,attr2,inode64,noquota)
  ```



















