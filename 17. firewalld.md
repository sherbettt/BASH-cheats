### § firewalld
<br/> [firewall-cmd](https://cheat.sh/firewall-cmd)

```
/etc/firewalld/
/lib/firewalld/services - шаблоны 
firewall-cmd
  	--get-default-zone
  	--get-active-zones
  	--set-default-zone=ZONE
   	--list-all [--zone=ZONE]
```

**Firewall-cmd** — это инструмент командной строки для управления сетевым брандмауэром FirewallD в Linux системах, такими как CentOS, Fedora и другие дистрибутивы на основе Red Hat Enterprise Linux. Вот подробная инструкция по работе с ним:

### Основные команды

#### Просмотр текущего состояния и конфигурации:
```bash
# Проверка статуса firewalld сервиса
sudo systemctl status firewalld

# Показать список активных зон
sudo firewall-cmd --get-active-zones

# Отображение всех правил и настроек зоны
sudo firewall-cmd --zone=public --list-all
```

#### Работа с зонами:
Зоны определяют уровень безопасности сети и правила обработки входящих соединений.

- **Получение списка всех доступных зон**
```bash
sudo firewall-cmd --get-zones
```

- **Установка активной зоны для интерфейса**
```bash
sudo firewall-cmd --change-interface=eth0 --zone=trusted
```

#### Управление правилами (services):

- **Открытие порта для TCP/UDP трафика**
```bash
sudo firewall-cmd --add-port=80/tcp --permanent # добавить правило навсегда
sudo firewall-cmd --reload               # перезагрузить настройки для применения изменений
```

- **Разрешить сервис SSH**
```bash
sudo firewall-cmd --add-service=ssh --permanent
sudo firewall-cmd --reload
```

- **Запретить конкретный порт или службу**
```bash
sudo firewall-cmd --remove-port=80/tcp --permanent
sudo firewall-cmd --remove-service=dns --permanent
```

#### Настройка NAT перенаправления:
Для переадресации пакетов между интерфейсами.

- **Настроить forwarding (NAT)**
```bash
sudo firewall-cmd --add-masquerade --permanent
sudo firewall-cmd --add-rich-rule='rule family="ipv4" source address="192.168.1.0/24" masquerade' --permanent
```

#### Работа с источниками IP адресов:
Можно разрешать доступ для конкретных IP адресов или сетей.

- **Открыть доступ для конкретного IP адреса**
```bash
sudo firewall-cmd --add-source=192.168.1.100 --zone=home --permanent
```

- **Заблокировать весь трафик от диапазона IP**
```bash
sudo firewall-cmd --add-rich-rule='rule family="ipv4" source address="172.16.0.0/16" drop'
```

#### Дополнительные возможности:

- **Проверка доступности сервиса/правила**
```bash
sudo firewall-cmd --query-service=http
```

- **Отключение службы временно**
```bash
sudo firewall-cmd --disable-service=smtp
```

- **Удаление ранее установленных правил**
```bash
sudo firewall-cmd --remove-port=8080/tcp --permanent
```

### Советы и рекомендации:

- Всегда проверяйте изменения командой `--list-all`, чтобы убедиться, что всё настроено правильно.
- Используйте параметр `--permanent` для сохранения настроек после перезагрузки системы.
- После внесения постоянных изменений обязательно применяйте команду `firewall-cmd --reload`.

Эти базовые знания позволят эффективно управлять файрволлом в вашей Linux среде!














