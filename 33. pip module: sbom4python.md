Оф. док.: [SBOM4Python](https://pypi.org/project/sbom4python/)
<br/> дополнение: [Generating distribution archives](https://packaging.python.org/en/latest/tutorials/packaging-projects/#generating-distribution-archives)


### sbom4python
**`sbom4python`** — это инструмент для генерации **SBOM (Software Bill of Materials)** для Python-проектов, Он анализирует зависимости (`requirements.txt`, `setup.py`, `pyproject.toml`) и создаёт SBOM в форматах:  **SPDX** (`.spdx`) ,  **CycloneDX** (`.json`).

#### **1. Проверьте, установлен ли CLI-интерфейс**  
Из вывода `pip3 show -f sbom4python` видно, что скрипт `sbom4python` должен быть доступен в `~/.local/bin/` (или `/home/<user>/.local/bin/sbom4python`).  

Попробуйте запустить его напрямую:  
```bash
~/.local/bin/sbom4python --help
```
Или добавьте `~/.local/bin` в `PATH`, если его там нет, а лучше сразу в `.bashrc`:  
```bash
export PATH=$PATH:~/.local/bin
sbom4python --help

# или

export PATH="$PATH:$HOME/.local/bin"
sbom4python --help
```

#### **2. Если CLI не работает — используйте как модуль**  
Поскольку `python3 -m sbom4python` не работает, значит, модуль не предназначен для прямого запуска. Вместо этого, его нужно использовать в Python-коде.  

Пример использования (предположительно):  
```python
from sbom4python.scanner import scan_project

# Сканируем проект и генерируем SBOM
sbom_data = scan_project("/path/to/your/python/project")
print(sbom_data)
```

#### **3. Изучите исходный код**  
Из структуры файлов видно, что основные модули:  
- `cli.py` — интерфейс командной строки (возможно, не установлен в `PATH`).  
- `scanner.py` — основной модуль сканирования зависимостей.  
- `license.py` — работа с лицензиями.  

Попробуйте заглянуть в `cli.py`, чтобы понять, какие аргументы принимает программа:  
```bash
cat ~/.local/lib/python3/site-packages/sbom4python/cli.py
cat ~/.local/lib/python3/site-packages/sbom4python/cli.py | grep sbom4python
```

#### **4. Официальная документация**  
Перейдите на [GitHub проекта](https://github.com/anthonyharrison/sbom4python) и проверьте **README.md**.  

#### **5. Альтернативный способ генерации SBOM**  
Если `sbom4python` не работает, можно попробовать другие инструменты:  
```bash
pip install cyclonedx-bom  
cyclonedx-py --help  # Генерация SBOM в формате CycloneDX
python3 -m sbom4python.cli --help
```

#### **6. Убедитесь, что модуль установлен**  
```bash
pip3 show sbom4python  # Проверка версии и пути
```
------------------------------

### Что произошло:
1. Вы использовали команду:  
   ```bash
   sbom4python -m . --output sbom.spdx --sbom spdx --format tag
   ```
   - `-m .` — анализ текущей директории как Python-модуля.  
   - `--sbom spdx` — выбор формата **SPDX**.  
   - `--format tag` — текстовое представление (SPDX-tag-value).  

2. Результат сохранён в файл **`sbom.spdx`** (вы можете открыть его в любом редакторе).  

### Как проверить содержимое SBOM?
```bash
cat sbom.spdx
```
Вы увидите структуру SPDX с метаданными проекта, зависимостями (если они есть) и лицензиями.  

---

### Что делать дальше?
#### 1. **Анализ зависимостей**  
Если в проекте есть `requirements.txt` или `pyproject.toml`, попробуйте явно указать их:  
```bash
sbom4python -r requirements.txt --output sbom.spdx --sbom spdx --format tag
```

#### 2. **Конвертация в JSON (если нужно)**  
```bash
sbom4python -m . --output sbom.spdx.json --sbom spdx --format json
```

#### 3. **Визуализация зависимостей**  
Если установлен `sbom2dot`, можно создать граф:  
```bash
sbom2dot --input sbom.spdx --output deps.dot
dot -Tpng deps.dot -o deps.png  # требует graphviz
```

#### 4. **Проверка на уязвимости**  
Используйте инструменты вроде:  
- `grype` (от Anchore):  
  ```bash
  grype sbom:./sbom.spdx
  ```
- `trivy` (от Aqua Security):  
  ```bash
  trivy sbom ./sbom.spdx
  ```

---

### Если SBOM пустой или не содержит ожидаемых зависимостей:
1. **Убедитесь, что зависимости установлены**  
   ```bash
   pip install -r requirements.txt
   ```
2. **Попробуйте ключ `--use-pip`**  
   ```bash
   sbom4python -m . --use-pip --output sbom.spdx --sbom spdx --format tag
   ```

3. **Вручную укажите модули**  
   ```bash
   sbom4python -m py_dz2_var1.py --output sbom.spdx --sbom spdx --format tag
   ```

---

### Альтернативные инструменты (если `sbom4python` не покрывает все нужды):
1. **`cyclonedx-py`** (для CycloneDX):  
   ```bash
   pip install cyclonedx-bom
   cyclonedx-py -o sbom.xml
   ```
2. **`syft`** (от Anchore):  
   ```bash
   syft dir:. -o spdx-json --file sbom.json
   ```

Если нужно что-то конкретное (например, проверка лицензий или экспорт в определённый формат) — уточните, и я помогу!


