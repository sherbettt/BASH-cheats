<details>
<summary>/etc/haproxy/haproxy.cfg</summary>

```cfg
global
    log /dev/log local0
    log /dev/log local1 notice
    chroot /var/lib/haproxy
    stats socket /run/haproxy/admin.sock mode 660 level admin
    stats timeout 30s
    user haproxy
    group haproxy
    daemon

defaults
    log global
    mode tcp
    option tcplog
    option dontlognull
    timeout connect 5000
    timeout client 50000
    timeout server 50000

listen stats
    bind *:7000
    mode http
    stats enable
    stats uri /
    stats refresh 10s
    stats admin if TRUE

backend postgres_master
    mode tcp
    balance roundrobin
    option httpchk GET /master
    http-check expect status 200
    default-server inter 3s fall 3 rise 2 on-marked-down shutdown-sessions
    server pg1 192.168.45.201:5432 check port 8008 inter 5s rise 2 fall 3
    server pg2 192.168.45.202:5432 check port 8008 inter 5s rise 2 fall 3
    server pg3 192.168.45.204:5432 check port 8008 inter 5s rise 2 fall 3

backend postgres_replica
    mode tcp
    balance roundrobin
    option httpchk GET /replica
    http-check expect status 200
    default-server inter 3s fall 3 rise 2 on-marked-down shutdown-sessions
    server pg1 192.168.45.201:5432 check port 8008 inter 5s rise 2 fall 3
    server pg2 192.168.45.202:5432 check port 8008 inter 5s rise 2 fall 3
    server pg3 192.168.45.204:5432 check port 8008 inter 5s rise 2 fall 3

frontend postgres_frontend
    bind *:5000
    mode tcp
    default_backend postgres_master

frontend postgres_readonly
    bind *:5001
    mode tcp
    default_backend postgres_replica

```
</details>

–í –∫–æ–Ω—Ü–µ —Ñ–∞–π–ª–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.

--------------
–≠—Ç–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª HAProxy, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è–º–∏ –∫ –∫–ª–∞—Å—Ç–µ—Ä—É PostgreSQL —Å Patroni.

### –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (global)
```cfg
log /dev/log local0          # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ syslog —Å —É—Ä–æ–≤–Ω–µ–º local0
log /dev/log local1 notice  # –î–æ–ø. –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —É—Ä–æ–≤–Ω–µ–º local1 –∏ –≤—ã—à–µ notice
chroot /var/lib/haproxy     # –ò–∑–æ–ª—è—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ chroot
stats socket /run/haproxy/admin.sock mode 660 level admin  # –°–æ–∫–µ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
stats timeout 30s           # –¢–∞–π–º–∞—É—Ç –¥–ª—è stats
user haproxy                # –ó–∞–ø—É—Å–∫ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è haproxy
group haproxy               # –∏ –≥—Ä—É–ø–ø—ã haproxy
daemon                      # –ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (defaults)
```cfg
log global                   # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
mode tcp                     # –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã —Å TCP (–Ω–µ HTTP)
option tcplog                # –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å TCP-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
option dontlognull           # –ù–µ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—É—Å—Ç—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
timeout connect 5000         # –¢–∞–π–º–∞—É—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è 5 —Å–µ–∫
timeout client 50000         # –¢–∞–π–º–∞—É—Ç –∫–ª–∏–µ–Ω—Ç–∞ 50 —Å–µ–∫
timeout server 50000         # –¢–∞–π–º–∞—É—Ç —Å–µ—Ä–≤–µ—Ä–∞ 50 —Å–µ–∫
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (listen stats)
```cfg
bind *:7000                  # –°–ª—É—à–∞—Ç—å –ø–æ—Ä—Ç 7000 –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
mode http                    # –†–µ–∂–∏–º HTTP –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
stats enable                 # –í–∫–ª—é—á–∏—Ç—å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
stats uri /                  # URL –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ - –∫–æ—Ä–µ–Ω—å
stats refresh 10s            # –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫
stats admin if TRUE          # –†–∞–∑—Ä–µ—à–∏—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –≤–µ–±
```

### –ë—ç–∫–µ–Ω–¥ –¥–ª—è –º–∞—Å—Ç–µ—Ä–∞ (backend postgres_master)
```cfg
mode tcp                     # TCP-—Ä–µ–∂–∏–º
balance roundrobin           # –ê–ª–≥–æ—Ä–∏—Ç–º –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ - round-robin
option httpchk GET /master   # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —á–µ—Ä–µ–∑ HTTP GET /master
http-check expect status 200 # –û–∂–∏–¥–∞—Ç—å HTTP 200 OK
default-server inter 3s fall 3 rise 2 on-marked-down shutdown-sessions
server pg1 192.168.45.201:5432 check port 8008 inter 5s rise 2 fall 3
server pg2 192.168.45.202:5432 check port 8008 inter 5s rise 2 fall 3
server pg3 192.168.45.204:5432 check port 8008 inter 5s rise 2 fall 3
```
(–ü—Ä–æ–≤–µ—Ä—è–µ—Ç Patroni API –Ω–∞ –ø–æ—Ä—Ç—É 8008, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–∞—Å—Ç–µ—Ä-–Ω–æ–¥—É)

### –ë—ç–∫–µ–Ω–¥ –¥–ª—è —Ä–µ–ø–ª–∏–∫ (backend postgres_replica)
```cfg
mode tcp                     # TCP-—Ä–µ–∂–∏–º
balance roundrobin           # –ê–ª–≥–æ—Ä–∏—Ç–º –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ - round-robin
option httpchk GET /replica  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —á–µ—Ä–µ–∑ HTTP GET /replica
http-check expect status 200 # –û–∂–∏–¥–∞—Ç—å HTTP 200 OK
default-server inter 3s fall 3 rise 2 on-marked-down shutdown-sessions
server pg1 192.168.45.201:5432 check port 8008 inter 5s rise 2 fall 3
server pg2 192.168.45.202:5432 check port 8008 inter 5s rise 2 fall 3
server pg3 192.168.45.204:5432 check port 8008 inter 5s rise 2 fall 3
```
(–ü—Ä–æ–≤–µ—Ä—è–µ—Ç Patroni API –Ω–∞ –ø–æ—Ä—Ç—É 8008, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω—ã–µ —Ä–µ–ø–ª–∏–∫–∏)


### **–°—Ç—Ä–æ–∫–∞ `default-server` (–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ –≤ –±—ç–∫–µ–Ω–¥–µ)**
```plaintext
default-server inter 3s fall 3 rise 2 on-marked-down shutdown-sessions
```
- **`inter 3s`** (interval)  
  ‚Üí –ò–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏ –∑–¥–æ—Ä–æ–≤—å—è (health checks) ‚Äî **3 —Å–µ–∫—É–Ω–¥—ã**.
  
- **`fall 3`**  
  ‚Üí –°–µ—Ä–≤–µ—Ä —Å—á–∏—Ç–∞–µ—Ç—Å—è "–Ω–µ—Ä–∞–±–æ—á–∏–º" (down), –µ—Å–ª–∏ **3 –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥—Ä—è–¥ –∑–∞–≤–µ—Ä—à–∏–ª–∏—Å—å –Ω–µ—É–¥–∞—á–Ω–æ**.  
  ‚Üí –≠—Ç–æ –∑–∞—â–∏—Ç–∞ –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑-–∑–∞ –∫—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π —Å–µ—Ç–µ–≤–æ–π –ø—Ä–æ–±–ª–µ–º—ã).

- **`rise 2`**  
  ‚Üí –°–µ—Ä–≤–µ—Ä —Å–Ω–æ–≤–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è "—Ä–∞–±–æ—á–∏–º" (up), –µ—Å–ª–∏ **2 –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥—Ä—è–¥ –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ**.  
  ‚Üí –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Å–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–æ–µ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ –≤ —Å—Ç—Ä–æ–π, –µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –µ—â—ë –Ω–µ —Å—Ç–∞–±–∏–ª–µ–Ω.

- **`on-marked-down shutdown-sessions`**  
  ‚Üí –ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ `down`, HAProxy **–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ —Ä–∞–∑—Ä—ã–≤–∞–µ—Ç –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è** –∫ –Ω–µ–º—É.  
  ‚Üí –≠—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è PostgreSQL, —á—Ç–æ–±—ã –∫–ª–∏–µ–Ω—Ç—ã –Ω–µ –ø—ã—Ç–∞–ª–∏—Å—å –ø–∏—Å–∞—Ç—å –≤ –æ—Ç–∫–ª—é—á—ë–Ω–Ω—ã–π –º–∞—Å—Ç–µ—Ä.



### **–°—Ç—Ä–æ–∫–∏ `server` (–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ PostgreSQL)**
```plaintext
server pg1 192.168.45.201:5432 check port 8008 inter 5s rise 2 fall 3
```
- **`server pg1 192.168.45.201:5432`**  
  ‚Üí –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–µ—Ä–≤–µ—Ä —Å –∏–º–µ–Ω–µ–º `pg1`, –¥–æ—Å—Ç—É–ø–Ω—ã–π –ø–æ –∞–¥—Ä–µ—Å—É `192.168.45.201:5432` (PostgreSQL).

- **`check`**  
  ‚Üí –í–∫–ª—é—á–∞–µ—Ç **–ø—Ä–æ–≤–µ—Ä–∫—É –∑–¥–æ—Ä–æ–≤—å—è** (health check) –¥–ª—è —ç—Ç–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞.

- **`port 8008`**  
  ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **–Ω–µ –Ω–∞ –ø–æ—Ä—Ç—É 5432 (PostgreSQL), –∞ –Ω–∞ 8008** (Patroni REST API).  
  ‚Üí Patroni –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç `/master` –∏ `/replica` —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–æ–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞.

- **`inter 5s`**  
  ‚Üí –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–æ–∫ –∑–¥–æ—Ä–æ–≤—å—è ‚Äî **5 —Å–µ–∫—É–Ω–¥** (–ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç `default-server inter 3s`).  
  ‚Üí –ë–æ–ª–µ–µ —Ä–µ–¥–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏, —á–µ–º –≤ `default-server`, —á—Ç–æ–±—ã —Å–Ω–∏–∑–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É.

- **`rise 2`**  
  ‚Üí –ö–∞–∫ –∏ –≤ `default-server`, –Ω–æ —è–≤–Ω–æ —É–∫–∞–∑–∞–Ω–æ –¥–ª—è —è—Å–Ω–æ—Å—Ç–∏.  
  ‚Üí 2 —É—Å–ø–µ—à–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ–±—ã —Å–µ—Ä–≤–µ—Ä —Å–Ω–æ–≤–∞ —Å—Ç–∞–ª `active`.

- **`fall 3`**  
  ‚Üí 3 –Ω–µ—É–¥–∞—á–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ–±—ã —Å–µ—Ä–≤–µ—Ä –ø–æ–º–µ—á–∞–ª—Å—è –∫–∞–∫ `down`.  
  ‚Üí –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ —Å `default-server`, –Ω–æ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤.


### **–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Å–≤—è–∑–∫–µ —Å Patroni?**
1. **HAProxy –ø—Ä–æ–≤–µ—Ä—è–µ—Ç Patroni API (`:8008`)**:
   - –î–ª—è –º–∞—Å—Ç–µ—Ä–∞: `GET /master` ‚Üí –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å `HTTP 200`.
   - –î–ª—è —Ä–µ–ø–ª–∏–∫–∏: `GET /replica` ‚Üí –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å `HTTP 200`.
2. **–ï—Å–ª–∏ –º–∞—Å—Ç–µ—Ä –ø–∞–¥–∞–µ—Ç**:
   - Patroni –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç —Ä–æ–ª—å –Ω–∞ –¥—Ä—É–≥—É—é –Ω–æ–¥—É.
   - HAProxy –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç —ç—Ç–æ —á–µ—Ä–µ–∑ `check port 8008` –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ –Ω–æ–≤—ã–π –º–∞—Å—Ç–µ—Ä.
3. **–ï—Å–ª–∏ —Ä–µ–ø–ª–∏–∫–∞ –æ—Ç—Å—Ç–∞—ë—Ç –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞**:
   - HAProxy –∏—Å–∫–ª—é—á–∞–µ—Ç –µ—ë –∏–∑ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ (`fall 3`), –ø–æ–∫–∞ –æ–Ω–∞ –Ω–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è (`rise 2`).


### –§—Ä–æ–Ω—Ç–µ–Ω–¥ –¥–ª—è –∑–∞–ø–∏—Å–∏ (frontend postgres_frontend)
```cfg
bind *:5000                  # –°–ª—É—à–∞—Ç—å –ø–æ—Ä—Ç 5000
mode tcp                     # TCP-—Ä–µ–∂–∏–º
default_backend postgres_master # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å –Ω–∞ –º–∞—Å—Ç–µ—Ä-–±—ç–∫–µ–Ω–¥
```

### –§—Ä–æ–Ω—Ç–µ–Ω–¥ –¥–ª—è —á—Ç–µ–Ω–∏—è (frontend postgres_readonly)
```cfg
bind *:5001                  # –°–ª—É—à–∞—Ç—å –ø–æ—Ä—Ç 5001
mode tcp                     # TCP-—Ä–µ–∂–∏–º
default_backend postgres_replica # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å –Ω–∞ —Ä–µ–ø–ª–∏–∫–∞-–±—ç–∫–µ–Ω–¥
```

–≠—Ç–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä–∞ —á–µ—Ä–µ–∑ Patroni API
2. –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —Ä–µ–ø–ª–∏–∫–∏ –¥–ª—è read-only –∑–∞–ø—Ä–æ—Å–æ–≤
3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤—Å–µ—Ö —É–∑–ª–æ–≤
4. –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –Ω–∞ –ø–æ—Ä—Ç—É 7000
5. –†–∞–∑–¥–µ–ª—å–Ω—ã–µ –ø–æ—Ä—Ç—ã –¥–ª—è –∑–∞–ø–∏—Å–∏ (5000) –∏ —á—Ç–µ–Ω–∏—è (5001)


--------------

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Å–∫—Ä—ã—Ç—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤:
```bash
cat -A /etc/haproxy/haproxy.cfg
```
### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏
```bash
ls -alF /etc/haproxy/haproxy.cfg
haproxy -c -f /etc/haproxy/haproxy.cfg
```
### HAProxy –≤ —Ä–µ–∂–∏–º–µ –æ—Ç–ª–∞–¥–∫–∏ –ø—Ä—è–º–æ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:
```bash
haproxy -f /etc/haproxy/haproxy.cfg -d
```

-------------------------

–û—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å! –Ø –¥–æ–ø—É—Å—Ç–∏–ª –æ—à–∏–±–∫—É –≤ –æ–±—ä—è—Å–Ω–µ–Ω–∏–∏. 

## üéØ **`daemon` - —ç—Ç–æ –Ω–µ —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –∞ facility (–∫–∞—Ç–µ–≥–æ—Ä–∏—è) –≤ syslog!**

### **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å:**
```bash
log /dev/log daemon    # –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤ /dev/log —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π "daemon"
```

## üìä **–ß—Ç–æ —Ç–∞–∫–æ–µ facility (–∫–∞—Ç–µ–≥–æ—Ä–∏–∏) –≤ syslog:**

### **–û—Å–Ω–æ–≤–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:**
```bash
auth       # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è/–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
authpriv   # –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
cron       # –î–µ–º–æ–Ω—ã cron
daemon     # –°–∏—Å—Ç–µ–º–Ω—ã–µ –¥–µ–º–æ–Ω—ã (–≤–∫–ª—é—á–∞—è HAProxy)
ftp        # FTP –¥–µ–º–æ–Ω
kern       # –Ø–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã
local0..7  # –õ–æ–∫–∞–ª—å–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (0-7)
lpr        # –°–∏—Å—Ç–µ–º–∞ –ø–µ—á–∞—Ç–∏
mail       # –ü–æ—á—Ç–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã
news       # –ù–æ–≤–æ—Å—Ç–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã
syslog     # –°–æ–æ–±—â–µ–Ω–∏—è —Å–∞–º–æ–≥–æ syslog
user       # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
uucp       # UUCP —Å–∏—Å—Ç–µ–º–∞
```

### **–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```bash
log /dev/log local0     # –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é 0
log /dev.log local1     # –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é 1  
log /dev/log user       # –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å
log /dev/log daemon     # –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫ —Å–∏—Å—Ç–µ–º–Ω—ã–π –¥–µ–º–æ–Ω (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è HAProxy)
```

## üîß **–ü–æ–ª–Ω—ã–π –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å:**

```bash
# –ü–æ–ª–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç: log <–∞–¥—Ä–µ—Å> [facility] [level] [minlevel]
log /dev/log daemon info          # –ö–∞—Ç–µ–≥–æ—Ä–∏—è daemon, —É—Ä–æ–≤–µ–Ω—å info –∏ –≤—ã—à–µ
log /dev/log local0 notice        # –ö–∞—Ç–µ–≥–æ—Ä–∏—è local0, —É—Ä–æ–≤–µ–Ω—å notice –∏ –≤—ã—à–µ
log /dev/log local1 debug         # –ö–∞—Ç–µ–≥–æ—Ä–∏—è local1, –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è (debug)
```


## üéØ **–ó–∞—á–µ–º –Ω—É–∂–Ω—ã facility (–∫–∞—Ç–µ–≥–æ—Ä–∏–∏):**

### **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –ø–æ —Å–ª—É–∂–±–∞–º:**
```
/var/log/syslog       # –í—Å–µ –ª–æ–≥–∏
/var/log/auth.log     # –¢–æ–ª—å–∫–æ auth facility
/var/log/daemon.log   # –¢–æ–ª—å–∫–æ daemon facility (–≥–¥–µ –±—É–¥–µ—Ç HAProxy)
```

### **–ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ rsyslog:**
```bash
# –í /etc/rsyslog.conf –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:
daemon.*    /var/log/daemon.log    # –í—Å–µ –ª–æ–≥–∏ –¥–µ–º–æ–Ω–æ–≤ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª
local0.*    /var/log/haproxy.log   # HAProxy –ª–æ–≥–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª
```


## ‚ö° **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è HAProxy:**

```bash
global
    # –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤ syslog —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π daemon, —É—Ä–æ–≤–µ–Ω—å notice
    log /dev/log daemon notice
    
    # –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏
    log /dev/log local0 info
```

**–ò—Ç–æ–≥:** `daemon` —É–∫–∞–∑—ã–≤–∞–µ—Ç syslog'—É –∫ –∫–∞–∫–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–ª—É–∂–± –æ—Ç–Ω–æ—Å—è—Ç—Å—è –ª–æ–≥–∏ HAProxy, —á—Ç–æ–±—ã –∏—Ö –º–æ–∂–Ω–æ –±—ã–ª–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∏ –Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã! üìä

-------------

## üìä –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ HAProxy

### **–û—Å–Ω–æ–≤–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:**

```bash
# –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π
log /dev/log emerg      # –°–∏—Å—Ç–µ–º–∞ –Ω–µ—Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–∞
log /dev/log alert      # –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ
log /dev/log crit       # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—Å–ª–æ–≤–∏—è
log /dev/log err        # –û—à–∏–±–∫–∏
log /dev/log warning    # –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
log /dev/log notice     # –ù–æ—Ä–º–∞–ª—å–Ω—ã–µ, –Ω–æ –∑–Ω–∞—á–∏–º—ã–µ —Å–æ–±—ã—Ç–∏—è
log /dev/log info       # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
log /dev/log debug      # –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
```

### **–ß—Ç–æ –æ–∑–Ω–∞—á–∞—é—Ç —É—Ä–æ–≤–Ω–∏ (–≤ –ø–æ—Ä—è–¥–∫–µ –≤–∞–∂–Ω–æ—Å—Ç–∏):**

#### **1. `emerg` (0) - –ß—Ä–µ–∑–≤—ã—á–∞–π–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è**
```
–°–∏—Å—Ç–µ–º–∞ –Ω–µ—Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–∞. –ü—Ä–∏–º–µ—Ä: –Ω–µ –º–æ–∂–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è, –Ω–µ—Ç –ø–∞–º—è—Ç–∏.
```

#### **2. `alert` (1) - –¢—Ä–µ–≤–æ–≥–∞**
```
–¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ. –ü—Ä–∏–º–µ—Ä: –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏.
```

#### **3. `crit` (2) - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π**
```
–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—Å–ª–æ–≤–∏—è. –ü—Ä–∏–º–µ—Ä: –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±—ç–∫–µ–Ω–¥–∞–º.
```

#### **4. `err` (3) - –û—à–∏–±–∫–∞**
```
–û—à–∏–±–∫–∏, —Ç—Ä–µ–±—É—é—â–∏–µ –≤–Ω–∏–º–∞–Ω–∏—è. –ü—Ä–∏–º–µ—Ä: —Ç–∞–π–º–∞—É—Ç—ã —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π, –æ—Ç–∫–∞–∑ –±—ç–∫–µ–Ω–¥–∞.
```

#### **5. `warning` (4) - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ**
```
–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è. –ü—Ä–∏–º–µ—Ä: —Å–µ—Ä–≤–µ—Ä –≤ –±—ç–∫–µ–Ω–¥–µ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.
```

#### **6. `notice` (5) - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ**
```
–ù–æ—Ä–º–∞–ª—å–Ω—ã–µ, –Ω–æ –∑–Ω–∞—á–∏–º—ã–µ —Å–æ–±—ã—Ç–∏—è. –ü—Ä–∏–º–µ—Ä: —Å–µ—Ä–≤–µ—Ä –≤–µ—Ä–Ω—É–ª—Å—è –≤ —Ä–∞–±–æ—Ç—É.
```

#### **7. `info` (6) - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è**
```
–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è. –ü—Ä–∏–º–µ—Ä: –∑–∞–ø—É—Å–∫/–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ HAProxy.
```

#### **8. `debug` (7) - –û—Ç–ª–∞–¥–∫–∞**
```
–ü–æ–¥—Ä–æ–±–Ω–∞—è –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è. –ü—Ä–∏–º–µ—Ä: –¥–µ—Ç–∞–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤.
```



## üéØ **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è HAProxy:**

### **–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:**
```bash
log /dev/log info        # –¢–æ–ª—å–∫–æ –≤–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏ –≤—ã—à–µ
# –∏–ª–∏
log /dev.log notice      # –ë–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ, –Ω–æ –±–µ–∑ –æ—Ç–ª–∞–¥–∫–∏
```

### **–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏/–æ—Ç–ª–∞–¥–∫–∏:**
```bash
log /dev/log debug       # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è
```

### **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```bash
log /dev/log warning     # –¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
```



## üîç **–ß—Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç HAProxy –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö:**

### **`warning` –∏ –≤—ã—à–µ:**
```bash
[WARNING] Server app/app1 is DOWN, reason: Connection refused
[ALERT] backend 'static' has no server available!
```

### **`notice` –∏ –≤—ã—à–µ:**
```bash
[NOTICE] haproxy version is 2.8.0
[NOTICE] Server app/app1 is UP
```

### **`info` –∏ –≤—ã—à–µ:**
```bash
[INFO] New worker #1 forked
```

### **`debug` (–≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è):**
```bash
[DEBUG] Processing ACL 'url_static'
[DEBUG] Selected server 'app1' for request
```


## ‚ö° **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:**

- **–ü—Ä–æ–¥–∞–∫—à–µ–Ω**: `notice` –∏–ª–∏ `info`
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: `info` 
- **–û—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º**: `debug`
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫**: `warning`

**–í –Ω–∞—à–µ–º –∫–æ–Ω—Ñ–∏–≥–µ `daemon` - —ç—Ç–æ –Ω–µ —É—Ä–æ–≤–µ–Ω—å, –∞ facility –≤ syslog!** –ü—Ä–∞–≤–∏–ª—å–Ω–æ –±—É–¥–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å —É—Ä–æ–≤–µ–Ω—å —è–≤–Ω–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä: `log /dev/log notice` üéØ

--------------------------

## üîí **Chroot –∏–∑–æ–ª—è—Ü–∏—è –≤ HAProxy**

### **–ß—Ç–æ —Ç–∞–∫–æ–µ chroot:**
```bash
chroot /var/lib/haproxy  # "–ó–∞—Ç–æ—á–∞–µ–º" HAProxy –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é /var/lib/haproxy
```
**–ü—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏:** –ü–æ—Å–ª–µ chroot –ø—Ä–æ—Ü–µ—Å—Å "–≤–∏–¥–∏—Ç" `/var/lib/haproxy` –∫–∞–∫ –∫–æ—Ä–Ω–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `/`



## üéØ **–î–ª—è —á–µ–≥–æ –Ω—É–∂–Ω–∞ chroot –∏–∑–æ–ª—è—Ü–∏—è:**

### **1. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞)**
```
–ë–µ–∑ chroot:   HAProxy ‚Üí /etc/passwd ‚Üí –£—Ç–µ—á–∫–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
–° chroot:     HAProxy ‚Üí /etc/passwd ‚Üí –§–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (–≤ –µ–≥–æ –º–∏—Ä–µ)
```

### **2. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ**
- ‚ùå **–ù–µ –º–æ–∂–µ—Ç** —á–∏—Ç–∞—Ç—å `/etc/shadow`, `/etc/passwd`
- ‚ùå **–ù–µ –º–æ–∂–µ—Ç** –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥–∏
- ‚ùå **–ù–µ –º–æ–∂–µ—Ç** –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º

### **3. –°–¥–µ—Ä–∂–∏–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π**
–ï—Å–ª–∏ HAProxy –±—É–¥–µ—Ç —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω, –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –ø–µ—Å–æ—á–Ω–∏—Ü–µ–π.


## üîß **–ß—Ç–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ chroot –æ–∫—Ä—É–∂–µ–Ω–∏–∏:**

```bash
/var/lib/haproxy/
‚îú‚îÄ‚îÄ dev/           # –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–Ω—É–∂–Ω—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã)
‚îÇ   ‚îú‚îÄ‚îÄ log        # –î–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ null       # /dev/null
‚îÇ   ‚îî‚îÄ‚îÄ zero       # /dev/zero
‚îú‚îÄ‚îÄ etc/           # –õ–æ–∫–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã)
‚îî‚îÄ‚îÄ tmp/           # –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
```


## ‚ö° **–ö–æ–≥–¥–∞ chroot –ö–†–ò–¢–ò–ß–ï–°–ö–ò –≤–∞–∂–µ–Ω:**

### **1. –ü—É–±–ª–∏—á–Ω—ã–µ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∏**
- –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∏ –≤ DMZ –∑–æ–Ω–µ
- –î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞

### **2. –ú—É–ª—å—Ç–∏—Ç–µ–Ω–∞–Ω—Ç–Ω—ã–µ —Å—Ä–µ–¥—ã**
- –†–∞–∑–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã –Ω–∞ –æ–¥–Ω–æ–º HAProxy
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è

### **3. –í—ã—Å–æ–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**
- PCI DSS, HIPAA, GDPR compliance
- –ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã



## üö® **–ö–æ–≥–¥–∞ –º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å chroot:**

### **1. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
```bash
# –í –∫–æ–Ω—Ñ–∏–≥–µ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å:
# chroot /var/lib/haproxy
```

### **2. –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å—é**
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è (health checks)
- –°–ª–æ–∂–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ SSL/TLS

### **3. –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ trusted —Å–µ—Ç–∏**
- –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∏ –≤–Ω—É—Ç—Ä–∏ –∑–∞—â–∏—â–µ–Ω–Ω–æ–≥–æ –ø–µ—Ä–∏–º–µ—Ç—Ä–∞
- –ö–æ–≥–¥–∞ —Ä–∏—Å–∫–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã


## üîç **–ü—Ä–æ–±–ª–µ–º—ã –∫–æ—Ç–æ—Ä—ã–µ –º—ã –≤–∏–¥–µ–ª–∏ –∏–∑-–∑–∞ chroot:**

```bash
[ALERT] sendmsg()/writev() failed in logger #1: No such file or directory
```
**–ü—Ä–∏—á–∏–Ω–∞:** –í chroot –æ–∫—Ä—É–∂–µ–Ω–∏–∏ –Ω–µ—Ç `/dev/log` –¥–ª—è syslog

**–†–µ—à–µ–Ω–∏–µ:**
```bash
mkdir -p /var/lib/haproxy/dev
touch /var/lib/haproxy/dev/log
```


## üìä **–ë–∞–ª–∞–Ω—Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏:**

| **–ë–µ–∑ chroot** | **–° chroot** |
|----------------|--------------|
| ‚úÖ –ü—Ä–æ—â–µ –æ—Ç–ª–∞–¥–∫–∞ | ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å |
| ‚úÖ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ | ‚ùå –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ |
| ‚ùå –†–∏—Å–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ | ‚úÖ Compliance |

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å chroot –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ, –æ—Ç–∫–ª—é—á–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤–µ—Å–∫–∏—Ö –ø—Ä–∏—á–∏–Ω–∞—Ö! üîí

--------------------------


