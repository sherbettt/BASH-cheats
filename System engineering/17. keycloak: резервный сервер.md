# Задание
Задание является логическим продолжением: 
- [15. ProxMox: установка etcd, Patroni, Haproxy](https://github.com/sherbettt/BASH-cheats/blob/main/System%20engineering/15.%20ProxMox:%20установка%20etcd,%20Patroni,%20Haproxy.md),
- [16. PSQL dump: клон + восстановление](https://github.com/sherbettt/BASH-cheats/blob/main/System%20engineering/16.%20PSQL%20dump%3A%20клон%20%2B%20восстановление.md)

Задание:
1) настроить **nginx**: *sso.runtel.ru:8443* на **192.168.87.2** (в **`/etc/nginx/sites-enabled`**)
2) продублировать контейнер с keycloak, проверить что работает через nginx
3) отключаешь 1ый контейнер с keycloak, проверяешь что всё продолжает работать

- [Модуль ngx_http_upstream_module](https://nginx.org/ru/docs/http/ngx_http_upstream_module.html)
- [Configuring Keycloak](https://www.keycloak.org/server/configuration)
- [Session storages in Keycloak 26 cheatsheet](https://www.keycloak.org/2024/12/storing-sessions-in-kc26)
<br/>



# Выполнение

## Определение 

### 1. Конфигурации.
Определим конфигурацию keyacloak на уже склоинрованной машине 192.168.46.16 (она же 192.168.45.50).
- не основная конф. в `/opt/keycloak-26.1.2/`;
- основная конф. в `/opt/keycloak/conf/keycloak.conf`.

Конфигурация Infinispan (кеширование):
- `/opt/keycloak/conf/cache-ispn.xml` (может потребоваться настройка, если используется распределённый кеш);

Конфигурация systemd-юнита:
- `/etc/systemd/system/keycloak.service` (если параметры передаются через командную строку, а не через `keycloak.conf`);


